function getid(a){return document.getElementById(a)}function GetItemCountInText(a,b){var c=0;for(var d=0;d<b.length;d++){if(currentTabText.indexOf(b[d])<0)continue;c+=1}return c}function GetPageCount(a){var b=getAllWord(),c=b.length;bOnlyCurrentTab&&(c=GetItemCountInText(currentTabText,b));var d=Math.floor(c/PAGE_SIZE);0<c%PAGE_SIZE&&(d+=1),a(d)}function UpdateWordCounts(){var a=getAllWord(),b=a.length,c=b;bOnlyCurrentTab&&(c=GetItemCountInText(currentTabText,a));var d=Math.floor(c/PAGE_SIZE);0<c%PAGE_SIZE&&(d+=1),getid("itemcount").innerHTML=currentpage+"/"+d+"页";var e=getid("span_newwords");e&&(e.innerHTML="，单词："+c+"个"),bgPage.setIcon({text:b.toString()})}function RemoveWord(a){delWord(a),bgPage.sendContextunhighlightword(a),UpdateWordCounts(),bgPage.refreshIcon(),bgPage.SyncSave()}function ShowPrevPage(){currentpage>1&&(currentpage--,ShowPage(currentpage))}function ShowNextPage(){GetPageCount(function(a){var b=currentpage+1;b<=a&&(currentpage++,ShowPage(currentpage))})}function SortData(a,b,c){SortFun.field=b,a.sort(SortFun),c=="desc"&&a.reverse()}function SortFun(a,b){return a[SortFun.field]>b[SortFun.field]?1:a[SortFun.field]<b[SortFun.field]?-1:0}function sortWordbyField(a,b){var c=[],d=getAllWord();bOnlyCurrentTab&&(currentTabText=bgPage.currentTabText);for(var e=0;e<d.length;e++){var f=getWordProperty(d[e]),g={word:d[e],chinese:f.chinese,sound:f.sound,count:f.count,ctime:f.ctime,pic:f.pic,picw:f.picw,pich:f.pich,tb:f.tb,tbw:f.tbw,tbh:f.tbh};if(bOnlyCurrentTab&&currentTabText.indexOf(d[e])<0)continue;c.push(g)}return SortData(c,a,b),c}function ListWordPageList(a){var b=GetGroupValue("rdOrderKey");b=b?b:"count";var c=GetGroupValue("rdOrder");c=c?c:"desc";var d=sortWordbyField(b,c),e=d.length;e>a*PAGE_SIZE&&(e=a*PAGE_SIZE);var f=[];for(var g=(a-1)*PAGE_SIZE;g<e;g++)f.push(d[g]);f.forEach(function(a){addWordUnit(a)})}function SetGroupValue(a,b){var c=document.getElementsByName(a);if(!c)return null;for(var d=0;d<c.length;d++)c[d].checked=!1,c[d].value==b&&(c[d].checked=!0)}function GetGroupValue(a){var b=document.getElementsByName(a);if(!b)return null;for(var c=0;c<b.length;c++)if(b[c].checked)return b[c].value;return null}function addNewWordUnit(a){var b=GetGroupValue("rdOrderKey");b=b?b:"count";var c=GetGroupValue("rdOrder");c=c?c:"desc";var d=sortWordbyField(b,c),e=d.length;if(e>a*PAGE_SIZE){var f=a*PAGE_SIZE;addWordUnit(d[f])}}function SetOrder(){localStorage.rdOrderKey=GetGroupValue("rdOrderKey"),localStorage.rdOrder=GetGroupValue("rdOrder"),currentpage=1;var a=document.getElementsByName("ckCurrent");a&&a[0].checked?(currentTabText=bgPage.currentTabText,localStorage.ckCurrent="currenttab",bOnlyCurrentTab=!0):(localStorage.ckCurrent="full",bOnlyCurrentTab=!1),ShowPage(currentpage),UpdateWordCounts()}function SetCaptureWord(){var a=document.getElementsByName("ckCaptureWord");a&&a[0].checked?localStorage.ckCaptureWord="CaptureWord":localStorage.ckCaptureWord="NotCaptureWord"}function SetXuanTingCaptureWord(){var a=document.getElementsByName("ckXuanTingCaptureWord");a&&a[0].checked?localStorage.ckXuanTingCaptureWord="CaptureWord":localStorage.ckXuanTingCaptureWord="NotCaptureWord"}function SubmitKeyClick(a){event.keyCode==13&&(document.getElementById(a).focus(),document.getElementById(a).click())}var bOnlyCurrentTab=!1,currentTabText="";