function Region(){this.left=999999,this.top=999999,this.right=0,this.bottom=0}(function(a,b){function c(){if(!q.isReady){try{t.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}q.ready()}}function d(a,b){b.src?q.ajax({url:b.src,async:!1,dataType:"script"}):q.globalEval(b.text||b.textContent||b.innerHTML||""),b.parentNode&&b.parentNode.removeChild(b)}function e(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&q.isFunction(d);for(j=0;j<i;j++)g(a[j],c,f?d.call(a[j],j,g(a[j],c)):d,h);return a}return i?g(a[0],c):b}function f(){return(new Date).getTime()}function g(){return!1}function h(){return!0}function i(a,b,c){return c[0].type=a,q.event.handle.apply(b,c)}function j(a){var b,c=[],d=[],e=arguments,f,g,h,i,j,k;g=q.data(this,"events");if(!(a.liveFired===this||!g||!g.live||a.button&&a.type==="click")){a.liveFired=this;var l=g.live.slice(0);for(i=0;i<l.length;i++)g=l[i],g.origType.replace(U,"")===a.type?d.push(g.selector):l.splice(i--,1);f=q(a.target).closest(d,a.currentTarget),j=0;for(k=f.length;j<k;j++)for(i=0;i<l.length;i++){g=l[i];if(f[j].selector===g.selector){h=f[j].elem,d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")d=q(a.relatedTarget).closest(g.selector)[0];(!d||d!==h)&&c.push({elem:h,handleObj:g})}}j=0;for(k=c.length;j<k;j++){f=c[j],a.currentTarget=f.elem,a.data=f.handleObj.data,a.handleObj=f.handleObj;if(f.handleObj.origHandler.apply(f.elem,e)===!1){b=!1;break}}return b}}function k(a,b){return"live."+(a&&a!=="*"?a+".":"")+b.replace(/\./g,"`").replace(/ /g,"&")}function l(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function m(a,b){var c=0;b.each(function(){if(this.nodeName===(a[c]&&a[c].nodeName)){var b=q.data(a[c++]),d=q.data(this,b);if(b=b&&b.events){delete d.handle,d.events={};for(var e in b)for(var f in b[e])q.event.add(this,e,b[e][f],b[e][f].data)}}})}function n(a,b,c){var d,e,f;return b=b&&b[0]?b[0].ownerDocument||b[0]:t,a.length===1&&typeof a[0]=="string"&&a[0].length<512&&b===t&&!bn.test(a[0])&&(q.support.checkClone||!bo.test(a[0]))&&(e=!0,(f=q.fragments[a[0]])&&f!==1&&(d=f)),d||(d=b.createDocumentFragment(),q.clean(a,b,d,c)),e&&(q.fragments[a[0]]=f?d:1),{fragment:d,cacheable:e}}function o(a,b){var c={};return q.each(bT.concat.apply([],bT.slice(0,b)),function(){c[this]=a}),c}function p(a){return"scrollTo"in a&&a.document?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var q=function(a,b){return new q.fn.init(a,b)},r=a.jQuery,s=a.$,t=a.document,u,v=/^[^<]*(<[\w\W]+>)[^>]*$|^#([\w-]+)$/,w=/^.[^:#\[\.,]*$/,x=/\S/,y=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,z=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,A=navigator.userAgent,B=!1,C=[],D,E=Object.prototype.toString,F=Object.prototype.hasOwnProperty,G=Array.prototype.push,H=Array.prototype.slice,I=Array.prototype.indexOf;q.fn=q.prototype={init:function(a,c){var d,e;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!c)return this.context=t,this[0]=t.body,this.selector="body",this.length=1,this;if(typeof a=="string"){if((d=v.exec(a))&&(d[1]||!c)){if(d[1])return e=c?c.ownerDocument||c:t,(a=z.exec(a))?q.isPlainObject(c)?(a=[t.createElement(a[1])],q.fn.attr.call(a,c,!0)):a=[e.createElement(a[1])]:(a=n([d[1]],[e]),a=(a.cacheable?a.fragment.cloneNode(!0):a.fragment).childNodes),q.merge(this,a);if(c=t.getElementById(d[2])){if(c.id!==d[2])return u.find(a);this.length=1,this[0]=c}return this.context=t,this.selector=a,this}return!c&&/^\w+$/.test(a)?(this.selector=a,this.context=t,a=t.getElementsByTagName(a),q.merge(this,a)):!c||c.jquery?(c||u).find(a):q(c).find(a)}return q.isFunction(a)?u.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),q.makeArray(a,this))},selector:"",jquery:"1.4.2",length:0,size:function(){return this.length},toArray:function(){return H.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this.slice(a)[0]:this[a]},pushStack:function(a,b,c){var d=q();return q.isArray(a)?G.apply(d,a):q.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return q.each(this,a,b)},ready:function(a){return q.bindReady(),q.isReady?a.call(t,q):C&&C.push(a),this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(H.apply(this,arguments),"slice",H.call(arguments).join(","))},map:function(a){return this.pushStack(q.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||q(null)},push:G,sort:[].sort,splice:[].splice},q.fn.init.prototype=q.fn,q.extend=q.fn.extend=function(){var a=arguments[0]||{},c=1,d=arguments.length,e=!1,f,g,h,i;typeof a=="boolean"&&(e=a,a=arguments[1]||{},c=2),typeof a!="object"&&!q.isFunction(a)&&(a={}),d===c&&(a=this,--c);for(;c<d;c++)if((f=arguments[c])!=null)for(g in f)h=a[g],i=f[g],a!==i&&(e&&i&&(q.isPlainObject(i)||q.isArray(i))?(h=h&&(q.isPlainObject(h)||q.isArray(h))?h:q.isArray(i)?[]:{},a[g]=q.extend(e,h,i)):i!==b&&(a[g]=i));return a},q.extend({noConflict:function(b){return a.$=s,b&&(a.jQuery=r),q},isReady:!1,ready:function(){if(!q.isReady){if(!t.body)return setTimeout(q.ready,13);q.isReady=!0;if(C){for(var a,b=0;a=C[b++];)a.call(t,q);C=null}q.fn.triggerHandler&&q(t).triggerHandler("ready")}},bindReady:function(){if(!B){B=!0;if(t.readyState==="complete")return q.ready();if(t.addEventListener)t.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",q.ready,!1);else if(t.attachEvent){t.attachEvent("onreadystatechange",D),a.attachEvent("onload",q.ready);var b=!1;try{b=a.frameElement==null}catch(d){}t.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return E.call(a)==="[object Function]"},isArray:function(a){return E.call(a)==="[object Array]"},isPlainObject:function(a){if(!a||E.call(a)!=="[object Object]"||a.nodeType||a.setInterval)return!1;if(a.constructor&&!F.call(a,"constructor")&&!F.call(a.constructor.prototype,"isPrototypeOf"))return!1;var c;for(c in a);return c===b||F.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=q.trim(b);if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return a.JSON&&a.JSON.parse?a.JSON.parse(b):(new Function("return "+b))();q.error("Invalid JSON: "+b)},noop:function(){},globalEval:function(a){if(a&&x.test(a)){var b=t.getElementsByTagName("head")[0]||t.documentElement,c=t.createElement("script");c.type="text/javascript",q.support.scriptEval?c.appendChild(t.createTextNode(a)):c.text=a,b.insertBefore(c,b.firstChild),b.removeChild(c)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||q.isFunction(a);if(d){if(h){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;f<g;)if(c.apply(a[f++],d)===!1)break}else if(h){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(d=a[0];f<g&&c.call(d,f,d)!==!1;d=a[++f]);return a},trim:function(a){return(a||"").replace(y,"")},makeArray:function(a,b){return b=b||[],a!=null&&(a.length==null||typeof a=="string"||q.isFunction(a)||typeof a!="function"&&a.setInterval?G.call(b,a):q.merge(b,a)),b},inArray:function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=c[e++];return a.length=d,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length;e<f;e++)!c!=!b(a[e],e)&&d.push(a[e]);return d},map:function(a,b,c){for(var d=[],e,f=0,g=a.length;f<g;f++)e=b(a[f],f,c),e!=null&&(d[d.length]=e);return d.concat.apply([],d)},guid:1,proxy:function(a,c,d){return arguments.length===2&&(typeof c=="string"?(d=a,a=d[c],c=b):c&&!q.isFunction(c)&&(d=c,c=b)),!c&&a&&(c=function(){return a.apply(d||this,arguments)}),a&&(c.guid=a.guid=a.guid||c.guid||q.guid++),c},uaMatch:function(a){return a=a.toLowerCase(),a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[],{browser:a[1]||"",version:a[2]||"0"}},browser:{}}),A=q.uaMatch(A),A.browser&&(q.browser[A.browser]=!0,q.browser.version=A.version),q.browser.webkit&&(q.browser.safari=!0),I&&(q.inArray=function(a,b){return I.call(b,a)}),u=q(t),t.addEventListener?D=function(){t.removeEventListener("DOMContentLoaded",D,!1),q.ready()}:t.attachEvent&&(D=function(){t.readyState==="complete"&&(t.detachEvent("onreadystatechange",D),q.ready())}),function(){q.support={};var b=t.documentElement,c=t.createElement("script"),d=t.createElement("div"),e="script"+f();d.style.display="none",d.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var g=d.getElementsByTagName("*"),h=d.getElementsByTagName("a")[0];if(!(!g||!g.length||!h)){q.support={leadingWhitespace:d.firstChild.nodeType===3,tbody:!d.getElementsByTagName("tbody").length,htmlSerialize:!!d.getElementsByTagName("link").length,style:/red/.test(h.getAttribute("style")),hrefNormalized:h.getAttribute("href")==="/a",opacity:/^0.55$/.test(h.style.opacity),cssFloat:!!h.style.cssFloat,checkOn:d.getElementsByTagName("input")[0].value==="on",optSelected:t.createElement("select").appendChild(t.createElement("option")).selected,parentNode:d.removeChild(d.appendChild(t.createElement("div"))).parentNode===null,deleteExpando:!0,checkClone:!1,scriptEval:!1,noCloneEvent:!0,boxModel:null},c.type="text/javascript";try{c.appendChild(t.createTextNode("window."+e+"=1;"))}catch(i){}b.insertBefore(c,b.firstChild),a[e]&&(q.support.scriptEval=!0,delete a[e]);try{delete c.test}catch(j){q.support.deleteExpando=!1}b.removeChild(c),d.attachEvent&&d.fireEvent&&(d.attachEvent("onclick",function k(){q.support.noCloneEvent=!1,d.detachEvent("onclick",k)}),d.cloneNode(!0).fireEvent("onclick")),d=t.createElement("div"),d.innerHTML="<input type='radio' name='radiotest' checked='checked'/>",b=t.createDocumentFragment(),b.appendChild(d.firstChild),q.support.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,q(function(){var a=t.createElement("div");a.style.width=a.style.paddingLeft="1px",t.body.appendChild(a),q.boxModel=q.support.boxModel=a.offsetWidth===2,t.body.removeChild(a).style.display="none"}),b=function(a){var b=t.createElement("div");a="on"+a;var c=a in b;return c||(b.setAttribute(a,"return;"),c=typeof b[a]=="function"),c},q.support.submitBubbles=b("submit"),q.support.changeBubbles=b("change"),b=c=d=g=h=null}}(),q.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};var J="jQuery"+f(),K=0,L={};q.extend({cache:{},expando:J,noData:{embed:!0,object:!0,applet:!0},data:function(c,d,e){if(!c.nodeName||!q.noData[c.nodeName.toLowerCase()]){c=c==a?L:c;var f=c[J],g=q.cache;return!f&&typeof d=="string"&&e===b?null:(f||(f=++K),typeof d=="object"?(c[J]=f,g[f]=q.extend(!0,{},d)):g[f]||(c[J]=f,g[f]={}),c=g[f],e!==b&&(c[d]=e),typeof d=="string"?c[d]:c)}},removeData:function(b,c){if(!b.nodeName||!q.noData[b.nodeName.toLowerCase()]){b=b==a?L:b;var d=b[J],e=q.cache,f=e[d];c?f&&(delete f[c],q.isEmptyObject(f)&&q.removeData(b)):(q.support.deleteExpando?delete b[q.expando]:b.removeAttribute&&b.removeAttribute(q.expando),delete e[d])}}}),q.fn.extend({data:function(a,c){if(typeof a=="undefined"&&this.length)return q.data(this[0]);if(typeof a=="object")return this.each(function(){q.data(this,a)});var d=a.split(".");d[1]=d[1]?"."+d[1]:"";if(c===b){var e=this.triggerHandler("getData"+d[1]+"!",[d[0]]);return e===b&&this.length&&(e=q.data(this[0],a)),e===b&&d[1]?this.data(d[0]):e}return this.trigger("setData"+d[1]+"!",[d[0],c]).each(function(){q.data(this,a,c)})},removeData:function(a){return this.each(function(){q.removeData(this,a)})}}),q.extend({queue:function(a,b,c){if(a){b=(b||"fx")+"queue";var d=q.data(a,b);return c?(!d||q.isArray(c)?d=q.data(a,b,q.makeArray(c)):d.push(c),d):d||[]}},dequeue:function(a,b){b=b||"fx";var c=q.queue(a,b),d=c.shift();d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){q.dequeue(a,b)}))}}),q.fn.extend({queue:function(a,c){return typeof a!="string"&&(c=a,a="fx"),c===b?q.queue(this[0],a):this.each(function(){var b=q.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&q.dequeue(this,a)})},dequeue:function(a){return this.each(function(){q.dequeue(this,a)})},delay:function(a,b){return a=q.fx?q.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(){var c=this;setTimeout(function(){q.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var M=/[\n\t]/g,N=/\s+/,O=/\r/g,P=/href|src|style/,Q=/(button|input)/i,R=/(button|input|object|select|textarea)/i,S=/^(a|area)$/i,T=/radio|checkbox/;q.fn.extend({attr:function(a,b){return e(this,a,b,!0,q.attr)},removeAttr:function(a){return this.each(function(){q.attr(this,a,""),this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(q.isFunction(a))return this.each(function(b){var c=q(this);c.addClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string")for(var b=(a||"").split(N),c=0,d=this.length;c<d;c++){var e=this[c];if(e.nodeType===1)if(e.className){for(var f=" "+e.className+" ",g=e.className,h=0,i=b.length;h<i;h++)f.indexOf(" "+b[h]+" ")<0&&(g+=" "+b[h]);e.className=q.trim(g)}else e.className=a}return this},removeClass:function(a){if(q.isFunction(a))return this.each(function(b){var c=q(this);c.removeClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string"||a===b)for(var c=(a||"").split(N),d=0,e=this.length;d<e;d++){var f=this[d];if(f.nodeType===1&&f.className)if(a){for(var g=(" "+f.className+" ").replace(M," "),h=0,i=c.length;h<i;h++)g=g.replace(" "+c[h]+" "," ");f.className=q.trim(g)}else f.className=""}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return q.isFunction(a)?this.each(function(c){var d=q(this);d.toggleClass(a.call(this,c,d.attr("class"),b),b)}):this.each(function(){if(c==="string")for(var e,f=0,g=q(this),h=b,i=a.split(N);e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else if(c==="undefined"||c==="boolean")this.className&&q.data(this,"__className__",this.className),this.className=this.className||a===!1?"":q.data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if((" "+this[b].className+" ").replace(M," ").indexOf(a)>-1)return!0;return!1},val:function(a){if(a===b){var c=this[0];if(c){if(q.nodeName(c,"option"))return(c.attributes.value||{}).specified?c.value:c.text;if(q.nodeName(c,"select")){var d=c.selectedIndex,e=[],f=c.options;c=c.type==="select-one";if(d<0)return null;var g=c?d:0;for(d=c?d+1:f.length;g<d;g++){var h=f[g];if(h.selected){a=q(h).val();if(c)return a;e.push(a)}}return e}return T.test(c.type)&&!q.support.checkOn?c.getAttribute("value")===null?"on":c.value:(c.value||"").replace(O,"")}return b}var i=q.isFunction(a);return this.each(function(b){var c=q(this),d=a;if(this.nodeType===1){i&&(d=a.call(this,b,c.val())),typeof d=="number"&&(d+="");if(q.isArray(d)&&T.test(this.type))this.checked=q.inArray(c.val(),d)>=0;else if(q.nodeName(this,"select")){var e=q.makeArray(d);q("option",this).each(function(){this.selected=q.inArray(q(this).val(),e)>=0}),e.length||(this.selectedIndex=-1)}else this.value=d}})}}),q.extend({attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8)return b;if(e&&c in q.attrFn)return q(a)[c](d);e=a.nodeType!==1||!q.isXMLDoc(a);var f=d!==b;c=e&&q.props[c]||c;if(a.nodeType===1){var g=P.test(c);return c in a&&e&&!g?(f&&(c==="type"&&Q.test(a.nodeName)&&a.parentNode&&q.error("type property can't be changed"),a[c]=d),q.nodeName(a,"form")&&a.getAttributeNode(c)?a.getAttributeNode(c).nodeValue:c==="tabIndex"?(c=a.getAttributeNode("tabIndex"))&&c.specified?c.value:R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b:a[c]):!q.support.style&&e&&c==="style"?(f&&(a.style.cssText=""+d),a.style.cssText):(f&&a.setAttribute(c,""+d),a=!q.support.hrefNormalized&&e&&g?a.getAttribute(c,2):a.getAttribute(c),a===null?b:a)}return q.style(a,c,d)}});var U=/\.(.*)$/,V=function(a){return a.replace(/[^\w\s\.\|`]/g,function(a){return"\\"+a})};q.event={add:function(c,d,e,f){if(c.nodeType!==3&&c.nodeType!==8){c.setInterval&&c!==a&&!c.frameElement&&(c=a);var g,h;e.handler&&(g=e,e=g.handler),e.guid||(e.guid=q.guid++);if(h=q.data(c)){var i=h.events=h.events||{},j=h.handle;j||(h.handle=j=function(){return typeof q!="undefined"&&!q.event.triggered?q.event.handle.apply(j.elem,arguments):b}),j.elem=c,d=d.split(" ");for(var k,l=0,m;k=d[l++];){h=g?q.extend({},g):{handler:e,data:f},k.indexOf(".")>-1?(m=k.split("."),k=m.shift(),h.namespace=m.slice(0).sort().join(".")):(m=[],h.namespace=""),h.type=k,h.guid=e.guid;var n=i[k],o=q.event.special[k]||{};if(!n){n=i[k]=[];if(!o.setup||o.setup.call(c,f,m,j)===!1)c.addEventListener?c.addEventListener(k,j,!1):c.attachEvent&&c.attachEvent("on"+k,j)}o.add&&(o.add.call(c,h),h.handler.guid||(h.handler.guid=e.guid)),n.push(h),q.event.global[k]=!0}c=null}}},global:{},remove:function(a,b,c,d){if(a.nodeType!==3&&a.nodeType!==8){var e,f=0,g,h,i,j,k,l,m=q.data(a),n=m&&m.events;if(m&&n){b&&b.type&&(c=b.handler,b=b.type);if(!b||typeof b=="string"&&b.charAt(0)==="."){b=b||"";for(e in n)q.event.remove(a,e+b)}else{for(b=b.split(" ");e=b[f++];){j=e,g=e.indexOf(".")<0,h=[],g||(h=e.split("."),e=h.shift(),i=new RegExp("(^|\\.)"+q.map(h.slice(0).sort(),V).join("\\.(?:.*\\.)?")+"(\\.|$)"));if(k=n[e])if(c){j=q.event.special[e]||{};for(o=d||0;o<k.length;o++){l=k[o];if(c.guid===l.guid){if(g||i.test(l.namespace))d==null&&k.splice(o--,1),j.remove&&j.remove.call(a,l);if(d!=null)break}}if(k.length===0||d!=null&&k.length===1)(!j.teardown||j.teardown.call(a,h)===!1)&&W(a,e,m.handle),delete n[e]}else for(var o=0;o<k.length;o++){l=k[o];if(g||i.test(l.namespace))q.event.remove(a,j,l.handler,o),k.splice(o--,1)}}if(q.isEmptyObject(n)){if(b=m.handle)b.elem=null;delete m.events,delete m.handle,q.isEmptyObject(m)&&q.removeData(a)}}}}},trigger:function(a,c,d,e){var f=a.type||a;if(!e){a=typeof a=="object"?a[J]?a:q.extend(q.Event(f),a):q.Event(f),f.indexOf("!")>=0&&(a.type=f=f.slice(0,-1),a.exclusive=!0),d||(a.stopPropagation(),q.event.global[f]&&q.each(q.cache,function(){this.events&&this.events[f]&&q.event.trigger(a,c,this.handle.elem)}));if(!d||d.nodeType===3||d.nodeType===8)return b;a.result=b,a.target=d,c=q.makeArray(c),c.unshift(a)}a.currentTarget=d,(e=q.data(d,"handle"))&&e.apply(d,c),e=d.parentNode||d.ownerDocument;try{d&&d.nodeName&&q.noData[d.nodeName.toLowerCase()]||d["on"+f]&&d["on"+f].apply(d,c)===!1&&(a.result=!1)}catch(g){}if(!a.isPropagationStopped()&&e)q.event.trigger(a,c,e,!0);else if(!a.isDefaultPrevented()){e=a.target;var h,i=q.nodeName(e,"a")&&f==="click",j=q.event.special[f]||{};if((!j._default||j._default.call(d,a)===!1)&&!i&&!(e&&e.nodeName&&q.noData[e.nodeName.toLowerCase()])){try{if(e[f]){if(h=e["on"+f])e["on"+f]=null;q.event.triggered=!0,e[f]()}}catch(k){}h&&(e["on"+f]=h),q.event.triggered=!1}}},handle:function(c){var d,e,f,g;c=arguments[0]=q.event.fix(c||a.event),c.currentTarget=this,d=c.type.indexOf(".")<0&&!c.exclusive,d||(e=c.type.split("."),c.type=e.shift(),f=new RegExp("(^|\\.)"+e.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")),g=q.data(this,"events"),e=g[c.type];if(g&&e){e=e.slice(0),g=0;for(var h=e.length;g<h;g++){var i=e[g];if(d||f.test(i.namespace)){c.handler=i.handler,c.data=i.data,c.handleObj=i,i=i.handler.apply(this,arguments),i!==b&&(c.result=i,i===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[J])return a;var c=a;a=q.Event(c);for(var d=this.props.length,e;d;)e=this.props[--d],a[e]=c[e];return a.target||(a.target=a.srcElement||t),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement),a.pageX==null&&a.clientX!=null&&(c=t.documentElement,d=t.body,a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),a.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0)),!a.which&&(a.charCode||a.charCode===0?a.charCode:a.keyCode)&&(a.which=a.charCode||a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0),a},guid:1e8,proxy:q.proxy,special:{ready:{setup:q.bindReady,teardown:q.noop},live:{add:function(a){q.event.add(this,a.origType,q.extend({},a,{handler:j}))},remove:function(a){var b=!0,c=a.origType.replace(U,"");q.each(q.data(this,"events").live||[],function(){if(c===this.origType.replace(U,""))return b=!1}),b&&q.event.remove(this,a.origType,j)}},beforeunload:{setup:function(a,b,c){return this.setInterval&&(this.onbeforeunload=c),!1},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}};var W=t.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent("on"+b,c)};q.Event=function(a){if(!this.preventDefault)return new q.Event(a);a&&a.type?(this.originalEvent=a,this.type=a.type):this.type=a,this.timeStamp=f(),this[J]=!0},q.Event.prototype={preventDefault:function(){this.isDefaultPrevented=h;var a=this.originalEvent;a&&(a.preventDefault&&a.preventDefault(),a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=h;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h,this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g};var X=function(a){var b=a.relatedTarget;try{for(;b&&b!==this;)b=b.parentNode;b!==this&&(a.type=a.data,q.event.handle.apply(this,arguments))}catch(c){}},Y=function(a){a.type=a.data,q.event.handle.apply(this,arguments)};q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){q.event.special[a]={setup:function(c){q.event.add(this,b,c&&c.selector?Y:X,a)},teardown:function(a){q.event.remove(this,b,a&&a.selector?Y:X)}}}),q.support.submitBubbles||(q.event.special.submit={setup:function(){if(this.nodeName.toLowerCase()==="form")return!1;q.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;if((c==="submit"||c==="image")&&q(b).closest("form").length)return i("submit",this,arguments)}),q.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;if((c==="text"||c==="password")&&q(b).closest("form").length&&a.keyCode===13)return i("submit",this,arguments)})},teardown:function(){q.event.remove(this,".specialSubmit")}});if(!q.support.changeBubbles){var Z=/textarea|input|select/i,$,_=function(a){var b=a.type,c=a.value;return b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?q.map(a.options,function(a){return a.selected}).join("-"):"":a.nodeName.toLowerCase()==="select"&&(c=a.selectedIndex),c},ba=function(a,c){var d=a.target,e,f;if(!!Z.test(d.nodeName)&&!d.readOnly){e=q.data(d,"_change_data"),f=_(d),(a.type!=="focusout"||d.type!=="radio")&&q.data(d,"_change_data",f);if(e!==b&&f!==e)if(e!=null||f)return a.type="change",q.event.trigger(a,c,d)}};q.event.special.change={filters:{focusout:ba,click:function(a){var b=a.target,c=b.type;if(c==="radio"||c==="checkbox"||b.nodeName.toLowerCase()==="select")return ba.call(this,a)},keydown:function(a){var b=a.target,c=b.type;if(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")return ba.call(this,a)},beforeactivate:function(a){a=a.target,q.data(a,"_change_data",_(a))}},setup:function(){if(this.type==="file")return!1;for(var a in $)q.event.add(this,a+".specialChange",$[a]);return Z.test(this.nodeName)},teardown:function(){return q.event.remove(this,".specialChange"),Z.test(this.nodeName)}},$=q.event.special.change.filters}t.addEventListener&&q.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){return a=q.event.fix(a),a.type=b,q.event.handle.call(this,a)}q.event.special[b]={setup:function(){this.addEventListener(a,c,!0)},teardown:function(){this.removeEventListener(a,c,!0)}}}),q.each(["bind","one"],function(a,c){q.fn[c]=function(a,d,e){if(typeof a=="object"){for(var f in a)this[c](f,d,a[f],e);return this}q.isFunction(d)&&(e=d,d=b);var g=c==="one"?q.proxy(e,function(a){return q(this).unbind(a,g),e.apply(this,arguments)}):e;if(a==="unload"&&c!=="one")this.one(a,d,e);else{f=0;for(var h=this.length;f<h;f++)q.event.add(this[f],a,g,d)}return this}}),q.fn.extend({unbind:function(a,b){if(typeof a=="object"&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else{c=0;for(var d=this.length;c<d;c++)q.event.remove(this[c],a,b)}return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){q.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return a=q.Event(a),a.preventDefault(),a.stopPropagation(),q.event.trigger(a,b,this[0]),a.result},toggle:function(a){for(var b=arguments,c=1;c<b.length;)q.proxy(a,b[c++]);return this.click(q.proxy(a,function(d){var e=(q.data(this,"lastToggle"+a.guid)||0)%c;return q.data(this,"lastToggle"+a.guid,e+1),d.preventDefault(),b[e].apply(this,arguments)||!1}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var bb={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};q.each(["live","die"],function(a,c){q.fn[c]=function(a,d,e,f){var g,h=0,i,j,l=f||this.selector,m=f?this:q(this.context);q.isFunction(d)&&(e=d,d=b);for(a=(a||"").split(" ");(g=a[h++])!=null;)f=U.exec(g),i="",f&&(i=f[0],g=g.replace(U,"")),g==="hover"?a.push("mouseenter"+i,"mouseleave"+i):(j=g,g==="focus"||g==="blur"?(a.push(bb[g]+i),g+=i):g=(bb[g]||g)+i,c==="live"?m.each(function(){q.event.add(this,k(g,l),{data:d,selector:l,handler:e,origType:g,origHandler:e,preType:j})}):m.unbind(k(g,l),e));return this}}),q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){q.fn[b]=function(a){return a?this.bind(b,a):this.trigger(b)},q.attrFn&&(q.attrFn[b]=!0)}),a.attachEvent&&!a.addEventListener&&a.attachEvent("onunload",function(){for(var a in q.cache)if(q.cache[a].handle)try{q.event.remove(q.cache[a].handle.elem)}catch(b){}}),function(){function a(b){for(var c="",d,e=0;b[e];e++)d=b[e],d.nodeType===3||d.nodeType===4?c+=d.nodeValue:d.nodeType!==8&&(c+=a(d.childNodes));return c}function c(a,b,c,d,e,f){e=0;for(var g=d.length;e<g;e++){var h=d[e];if(h){h=h[a];for(var i=!1;h;){if(h.sizcache===c){i=d[h.sizset];break}h.nodeType===1&&!f&&(h.sizcache=c,h.sizset=e);if(h.nodeName.toLowerCase()===b){i=h;break}h=h[a]}d[e]=i}}}function d(a,b,c,d,e,f){e=0;for(var g=d.length;e<g;e++){var h=d[e];if(h){h=h[a];for(var i=!1;h;){if(h.sizcache===c){i=d[h.sizset];break}if(h.nodeType===1){f||(h.sizcache=c,h.sizset=e);if(typeof b!="string"){if(h===b){i=!0;break}}else if(j.filter(b,[h]).length>0){i=h;break}}h=h[a]}d[e]=i}}}var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,f=0,g=Object.prototype.toString,h=!1,i=!0;[0,0].sort(function(){return i=!1,0});var j=function(a,b,c,d){c=c||[];var f=b=b||t;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!="string")return c;for(var h=[],i,m,o,p,q=!0,v=s(b),w=a;(e.exec(""),i=e.exec(w))!==null;){w=i[3],h.push(i[1]);if(i[2]){p=i[3];break}}if(h.length>1&&l.exec(a))if(h.length===2&&k.relative[h[0]])m=u(h[0]+h[1],b);else for(m=k.relative[h[0]]?[b]:j(h.shift(),b);h.length;)a=h.shift(),k.relative[a]&&(a+=h.shift()),m=u(a,m);else{!d&&h.length>1&&b.nodeType===9&&!v&&k.match.ID.test(h[0])&&!k.match.ID.test(h[h.length-1])&&(i=j.find(h.shift(),b,v),b=i.expr?j.filter(i.expr,i.set)[0]:i.set[0]);if(b){i=d?{expr:h.pop(),set:n(d)}:j.find(h.pop(),h.length!==1||h[0]!=="~"&&h[0]!=="+"||!b.parentNode?b:b.parentNode,v),m=i.expr?j.filter(i.expr,i.set):i.set,h.length>0?o=n(m):q=!1;for(;h.length;){var x=h.pop();i=x,k.relative[x]?i=h.pop():x="",i==null&&(i=b),k.relative[x](o,i,v)}}else o=[]}o||(o=m),o||j.error(x||a);if(g.call(o)==="[object Array]")if(q)if(b&&b.nodeType===1)for(a=0;o[a]!=null;a++)o[a]&&(o[a]===!0||o[a].nodeType===1&&r(b,o[a]))&&c.push(m[a]);else for(a=0;o[a]!=null;a++)o[a]&&o[a].nodeType===1&&c.push(m[a]);else c.push.apply(c,o);else n(o,c);return p&&(j(p,f,c,d),j.uniqueSort(c)),c};j.uniqueSort=function(a){if(p){h=i,a.sort(p);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},j.matches=function(a,b){return j(a,null,null,b)},j.find=function(a,b,c){var d,e;if(!a)return[];for(var f=0,g=k.order.length;f<g;f++){var h=k.order[f];if(e=k.leftMatch[h].exec(a)){var i=e[1];e.splice(1,1);if(i.substr(i.length-1)!=="\\"){e[1]=(e[1]||"").replace(/\\/g,""),d=k.find[h](e,b,c);if(d!=null){a=a.replace(k.match[h],"");break}}}}return d||(d=b.getElementsByTagName("*")),{set:d,expr:a}},j.filter=function(a,c,d,e){for(var f=a,g=[],h=c,i,l,m=c&&c[0]&&s(c[0]);a&&c.length;){for(var n in k.filter)if((i=k.leftMatch[n].exec(a))!=null&&i[2]){var o=k.filter[n],p,q;q=i[1],l=!1,i.splice(1,1);if(q.substr(q.length-1)!=="\\"){h===g&&(g=[]);if(k.preFilter[n])if(i=k.preFilter[n](i,h,d,g,e,m)){if(i===!0)continue}else l=p=!0;if(i)for(var r=0;(q=h[r])!=null;r++)if(q){p=o(q,i,r,h);var t=e^!!p;d&&p!=null?t?l=!0:h[r]=!1:t&&(g.push(q),l=!0)}if(p!==b){d||(h=g),a=a.replace(k.match[n],"");if(!l)return[];break}}}if(a===f){if(l!=null)break;j.error(a)}f=a}return h},j.error=function(a){throw"Syntax error, unrecognized expression: "+a};var k=j.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!/\W/.test(b);c=c&&!d,d&&(b=b.toLowerCase()),d=0;for(var e=a.length,f;d<e;d++)if(f=a[d]){for(;(f=f.previousSibling)&&f.nodeType!==1;);a[d]=c||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}c&&j.filter(b,a,!0)},">":function(a,b){var c=typeof b=="string";if(c&&!/\W/.test(b)){b=b.toLowerCase();for(var d=0,e=a.length;d<e;d++){var f=a[d];f&&(c=f.parentNode,a[d]=c.nodeName.toLowerCase()===b?c:!1)}}else{d=0;for(e=a.length;d<e;d++)if(f=a[d])a[d]=c?f.parentNode:f.parentNode===b;c&&j.filter(b,a,!0)}},"":function(a,b,e){var g=f++,h=d;if(typeof b=="string"&&!/\W/.test(b)){var i=b=b.toLowerCase();h=c}h("parentNode",b,g,a,i,e)},"~":function(a,b,e){var g=f++,h=d;if(typeof b=="string"&&!/\W/.test(b)){var i=b=b.toLowerCase();h=c}h("previousSibling",b,g,a,i,e)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c)return(a=b.getElementById(a[1]))?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[];b=b.getElementsByName(a[1]);for(var d=0,e=b.length;d<e;d++)b[d].getAttribute("name")===a[1]&&c.push(b[d]);return c.length===0?null:c}},TAG:function(a,b){return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(/\\/g,"")+" ";if(f)return a;f=0;for(var g;(g=b[f])!=null;f++)g&&(e^(g.className&&(" "+g.className+" ").replace(/[\t\n]/g," ").indexOf(a)>=0)?c||d.push(g):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(/\\/g,"")},TAG:function(a){return a[1].toLowerCase()},CHILD:function(a){if(a[1]==="nth"){var b=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+
a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}return a[0]=f++,a},ATTR:function(a,b,c,d,e,f){return b=a[1].replace(/\\/g,""),!f&&k.attrMap[b]&&(a[1]=k.attrMap[b]),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(a,b,c,d,f){if(a[1]==="not"){if(!((e.exec(a[3])||"").length>1||/^\w/.test(a[3])))return a=j.filter(a[3],b,c,!0^f),c||d.push.apply(d,a),!1;a[3]=j(a[3],null,null,b)}else if(k.match.POS.test(a[0])||k.match.CHILD.test(a[0]))return!0;return a},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!j(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toLowerCase()==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(b,c,d,e){var f=c[1],g=k.filters[f];if(g)return g(b,d,c,e);if(f==="contains")return(b.textContent||b.innerText||a([b])||"").indexOf(c[3])>=0;if(f==="not"){c=c[3],d=0;for(e=c.length;d<e;d++)if(c[d]===b)return!1;return!0}j.error("Syntax error, unrecognized expression: "+f)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":for(;d=d.previousSibling;)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":for(;d=d.nextSibling;)if(d.nodeType===1)return!1;return!0;case"nth":c=b[2];var e=b[3];if(c===1&&e===0)return!0;b=b[0];var f=a.parentNode;if(f&&(f.sizcache!==b||!a.nodeIndex)){var g=0;for(d=f.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++g);f.sizcache=b}return a=a.nodeIndex-e,c===0?a===0:a%c===0&&a/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1];a=k.attrHandle[c]?k.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),c=a+"";var d=b[2];return b=b[4],a==null?d==="!=":d==="="?c===b:d==="*="?c.indexOf(b)>=0:d==="~="?(" "+c+" ").indexOf(b)>=0:b?d==="!="?c!==b:d==="^="?c.indexOf(b)===0:d==="$="?c.substr(c.length-b.length)===b:d==="|="?c===b||c.substr(0,b.length+1)===b+"-":!1:c&&a!==!1},POS:function(a,b,c,d){var e=k.setFilters[b[2]];if(e)return e(a,c,b,d)}}},l=k.match.POS;for(var m in k.match)k.match[m]=new RegExp(k.match[m].source+/(?![^\[]*\])(?![^\(]*\))/.source),k.leftMatch[m]=new RegExp(/(^(?:.|\r|\n)*?)/.source+k.match[m].source.replace(/\\(\d+)/g,function(a,b){return"\\"+(b-0+1)}));var n=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(t.documentElement.childNodes,0)}catch(o){n=function(a,b){b=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(b,a);else if(typeof a.length=="number")for(var c=0,d=a.length;c<d;c++)b.push(a[c]);else for(c=0;a[c];c++)b.push(a[c]);return b}}var p;t.documentElement.compareDocumentPosition?p=function(a,b){return!a.compareDocumentPosition||!b.compareDocumentPosition?(a==b&&(h=!0),a.compareDocumentPosition?-1:1):(a=a.compareDocumentPosition(b)&4?-1:a===b?0:1,a===0&&(h=!0),a)}:"sourceIndex"in t.documentElement?p=function(a,b){return!a.sourceIndex||!b.sourceIndex?(a==b&&(h=!0),a.sourceIndex?-1:1):(a=a.sourceIndex-b.sourceIndex,a===0&&(h=!0),a)}:t.createRange&&(p=function(a,b){if(!a.ownerDocument||!b.ownerDocument)return a==b&&(h=!0),a.ownerDocument?-1:1;var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();return c.setStart(a,0),c.setEnd(a,0),d.setStart(b,0),d.setEnd(b,0),a=c.compareBoundaryPoints(Range.START_TO_END,d),a===0&&(h=!0),a}),function(){var a=t.createElement("div"),c="script"+(new Date).getTime();a.innerHTML="<a name='"+c+"'/>";var d=t.documentElement;d.insertBefore(a,d.firstChild),t.getElementById(c)&&(k.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d)return(c=c.getElementById(a[1]))?c.id===a[1]||typeof c.getAttributeNode!="undefined"&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:[]},k.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),d.removeChild(a),d=a=null}(),function(){var a=t.createElement("div");a.appendChild(t.createComment("")),a.getElementsByTagName("*").length>0&&(k.find.TAG=function(a,b){b=b.getElementsByTagName(a[1]);if(a[1]==="*"){a=[];for(var c=0;b[c];c++)b[c].nodeType===1&&a.push(b[c]);b=a}return b}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(k.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),t.querySelectorAll&&function(){var a=j,b=t.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){j=function(b,c,d,e){c=c||t;if(!e&&c.nodeType===9&&!s(c))try{return n(c.querySelectorAll(b),d)}catch(f){}return a(b,c,d,e)};for(var c in a)j[c]=a[c];b=null}}(),function(){var a=t.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>",!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1&&(k.order.splice(1,0,"CLASS"),k.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null))}();var r=t.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(a,b){return a!==b&&(a.contains?a.contains(b):!0)},s=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1},u=function(a,b){var c=[],d="",e;for(b=b.nodeType?[b]:b;e=k.match.PSEUDO.exec(a);)d+=e[0],a=a.replace(k.match.PSEUDO,"");a=k.relative[a]?a+"*":a,e=0;for(var f=b.length;e<f;e++)j(a,b[e],c);return j.filter(d,c)};q.find=j,q.expr=j.selectors,q.expr[":"]=q.expr.filters,q.unique=j.uniqueSort,q.text=a,q.isXMLDoc=s,q.contains=r}();var bc=/Until$/,bd=/^(?:parents|prevUntil|prevAll)/,be=/,/;H=Array.prototype.slice;var bf=function(a,b,c){if(q.isFunction(b))return q.grep(a,function(a,d){return!!b.call(a,d,a)===c});if(b.nodeType)return q.grep(a,function(a){return a===b===c});if(typeof b=="string"){var d=q.grep(a,function(a){return a.nodeType===1});if(w.test(b))return q.filter(b,d,!c);b=q.filter(b,d)}return q.grep(a,function(a){return q.inArray(a,b)>=0===c})};q.fn.extend({find:function(a){for(var b=this.pushStack("","find",a),c=0,d=0,e=this.length;d<e;d++){c=b.length,q.find(a,this[d],b);if(d>0)for(var f=c;f<b.length;f++)for(var g=0;g<c;g++)if(b[g]===b[f]){b.splice(f--,1);break}}return b},has:function(a){var b=q(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(q.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(bf(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bf(this,a,!0),"filter",a)},is:function(a){return!!a&&q.filter(a,this).length>0},closest:function(a,b){if(q.isArray(a)){var c=[],d=this[0],e,f={},g;if(d&&a.length){e=0;for(var h=a.length;e<h;e++)g=a[e],f[g]||(f[g]=q.expr.match.POS.test(g)?q(g,b||this.context):g);for(;d&&d.ownerDocument&&d!==b;){for(g in f){e=f[g];if(e.jquery?e.index(d)>-1:q(d).is(e))c.push({selector:g,elem:d}),delete f[g]}d=d.parentNode}}return c}var i=q.expr.match.POS.test(a)?q(a,b||this.context):null;return this.map(function(c,d){for(;d&&d.ownerDocument&&d!==b;){if(i?i.index(d)>-1:q(d).is(a))return d;d=d.parentNode}return null})},index:function(a){return!a||typeof a=="string"?q.inArray(this[0],a?q(a):this.parent().children()):q.inArray(a.jquery?a[0]:a,this)},add:function(a,b){return a=typeof a=="string"?q(a,b||this.context):q.makeArray(a),b=q.merge(this.get(),a),this.pushStack(l(a[0])||l(b[0])?b:q.unique(b))},andSelf:function(){return this.add(this.prevObject)}}),q.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==11?a:null},parents:function(a){return q.dir(a,"parentNode")},parentsUntil:function(a,b,c){return q.dir(a,"parentNode",c)},next:function(a){return q.nth(a,2,"nextSibling")},prev:function(a){return q.nth(a,2,"previousSibling")},nextAll:function(a){return q.dir(a,"nextSibling")},prevAll:function(a){return q.dir(a,"previousSibling")},nextUntil:function(a,b,c){return q.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return q.dir(a,"previousSibling",c)},siblings:function(a){return q.sibling(a.parentNode.firstChild,a)},children:function(a){return q.sibling(a.firstChild)},contents:function(a){return q.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:q.makeArray(a.childNodes)}},function(a,b){q.fn[a]=function(c,d){var e=q.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=q.filter(d,e)),e=this.length>1?q.unique(e):e,(this.length>1||be.test(d))&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,H.call(arguments).join(","))}}),q.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),q.find.matches(a,b)},dir:function(a,c,d){var e=[];for(a=a[c];a&&a.nodeType!==9&&(d===b||a.nodeType!==1||!q(a).is(d));)a.nodeType===1&&e.push(a),a=a[c];return e},nth:function(a,b,c){b=b||1;for(var d=0;a;a=a[c])if(a.nodeType===1&&++d===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var bg=/ jQuery\d+="(?:\d+|null)"/g,bh=/^\s+/,bi=/(<([\w:]+)[^>]*?)\/>/g,bj=/^(?:area|br|col|embed|hr|img|input|link|meta|param)$/i,bk=/<([\w:]+)/,bl=/<tbody/i,bm=/<|&#?\w+;/,bn=/<script|<object|<embed|<option|<style/i,bo=/checked\s*(?:[^=]|=\s*.checked.)/i,bp=function(a,b,c){return bj.test(c)?a:b+"></"+c+">"},bq={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};bq.optgroup=bq.option,bq.tbody=bq.tfoot=bq.colgroup=bq.caption=bq.thead,bq.th=bq.td,q.support.htmlSerialize||(bq._default=[1,"div<div>","</div>"]),q.fn.extend({text:function(a){return q.isFunction(a)?this.each(function(b){var c=q(this);c.text(a.call(this,b,c.text()))}):typeof a!="object"&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||t).createTextNode(a)):q.text(this)},wrapAll:function(a){if(q.isFunction(a))return this.each(function(b){q(this).wrapAll(a.call(this,b))});if(this[0]){var b=q(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return q.isFunction(a)?this.each(function(b){q(this).wrapInner(a.call(this,b))}):this.each(function(){var b=q(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){q(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){q.nodeName(this,"body")||q(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=q(arguments[0]);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,q(arguments[0]).toArray()),a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||q.filter(a,[d]).length)!b&&d.nodeType===1&&(q.cleanData(d.getElementsByTagName("*")),q.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&q.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a){var b=this.map(function(){if(!q.support.noCloneEvent&&!q.isXMLDoc(this)){var a=this.outerHTML,b=this.ownerDocument;return a||(a=b.createElement("div"),a.appendChild(this.cloneNode(!0)),a=a.innerHTML),q.clean([a.replace(bg,"").replace(/=([^="'>\s]+\/)>/g,'="$1">').replace(bh,"")],b)[0]}return this.cloneNode(!0)});return a===!0&&(m(this,b),m(this.find("*"),b.find("*"))),b},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(bg,""):null;if(typeof a=="string"&&!bn.test(a)&&(q.support.leadingWhitespace||!bh.test(a))&&!bq[(bk.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bi,bp);try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(q.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else q.isFunction(a)?this.each(function(b){var c=q(this),d=c.html();c.empty().append(function(){return a.call(this,b,d)})}):this.empty().append(a);return this},replaceWith:function(a){return this[0]&&this[0].parentNode?q.isFunction(a)?this.each(function(b){var c=q(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=q(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;q(this).remove(),b?q(b).before(a):q(c).append(a)})):this.pushStack(q(q.isFunction(a)?a():a),"replaceWith",a)},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,e){function f(a){return q.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}var g,h,i=a[0],j=[],k;if(!q.support.checkClone&&arguments.length===3&&typeof i=="string"&&bo.test(i))return this.each(function(){q(this).domManip(a,c,e,!0)});if(q.isFunction(i))return this.each(function(d){var f=q(this);a[0]=i.call(this,d,c?f.html():b),f.domManip(a,c,e)});if(this[0]){g=i&&i.parentNode,g=q.support.parentNode&&g&&g.nodeType===11&&g.childNodes.length===this.length?{fragment:g}:n(a,this,j),k=g.fragment;if(h=k.childNodes.length===1?k=k.firstChild:k.firstChild){c=c&&q.nodeName(h,"tr");for(var l=0,m=this.length;l<m;l++)e.call(c?f(this[l],h):this[l],l>0||g.cacheable||this.length>1?k.cloneNode(!0):k)}j.length&&q.each(j,d)}return this}}),q.fragments={},q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){q.fn[a]=function(c){var d=[];c=q(c);var e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&c.length===1)return c[b](this[0]),this;e=0;for(var f=c.length;e<f;e++){var g=(e>0?this.clone(!0):this).get();q.fn[b].apply(q(c[e]),g),d=d.concat(g)}return this.pushStack(d,a,c.selector)}}),q.extend({clean:function(a,b,c,d){b=b||t,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||t);for(var e=[],f=0,g;(g=a[f])!=null;f++){typeof g=="number"&&(g+="");if(g){if(typeof g=="string"&&!bm.test(g))g=b.createTextNode(g);else if(typeof g=="string"){g=g.replace(bi,bp);var h=(bk.exec(g)||["",""])[1].toLowerCase(),i=bq[h]||bq._default,j=i[0],k=b.createElement("div");for(k.innerHTML=i[1]+g+i[2];j--;)k=k.lastChild;if(!q.support.tbody){j=bl.test(g),h=h==="table"&&!j?k.firstChild&&k.firstChild.childNodes:i[1]==="<table>"&&!j?k.childNodes:[];for(i=h.length-1;i>=0;--i)q.nodeName(h[i],"tbody")&&!h[i].childNodes.length&&h[i].parentNode.removeChild(h[i])}!q.support.leadingWhitespace&&bh.test(g)&&k.insertBefore(b.createTextNode(bh.exec(g)[0]),k.firstChild),g=k.childNodes}g.nodeType?e.push(g):e=q.merge(e,g)}}if(c)for(f=0;e[f];f++)d&&q.nodeName(e[f],"script")&&(!e[f].type||e[f].type.toLowerCase()==="text/javascript")?d.push(e[f].parentNode?e[f].parentNode.removeChild(e[f]):e[f]):(e[f].nodeType===1&&e.splice.apply(e,[f+1,0].concat(q.makeArray(e[f].getElementsByTagName("script")))),c.appendChild(e[f]));return e},cleanData:function(a){for(var b,c,d=q.cache,e=q.event.special,f=q.support.deleteExpando,g=0,h;(h=a[g])!=null;g++)if(c=h[q.expando]){b=d[c];if(b.events)for(var i in b.events)e[i]?q.event.remove(h,i):W(h,i,b.handle);f?delete h[q.expando]:h.removeAttribute&&h.removeAttribute(q.expando),delete d[c]}}});var br=/z-?index|font-?weight|opacity|zoom|line-?height/i,bs=/alpha\([^)]*\)/,bt=/opacity=([^)]*)/,bu=/float/i,bv=/-([a-z])/ig,bw=/([A-Z])/g,bx=/^-?\d+(?:px)?$/i,by=/^-?\d/,bz={position:"absolute",visibility:"hidden",display:"block"},bA=["Left","Right"],bB=["Top","Bottom"],bC=t.defaultView&&t.defaultView.getComputedStyle,bD=q.support.cssFloat?"cssFloat":"styleFloat",bE=function(a,b){return b.toUpperCase()};q.fn.css=function(a,c){return e(this,a,c,!0,function(a,c,d){if(d===b)return q.curCSS(a,c);typeof d=="number"&&!br.test(c)&&(d+="px"),q.style(a,c,d)})},q.extend({style:function(a,c,d){if(!a||a.nodeType===3||a.nodeType===8)return b;(c==="width"||c==="height")&&parseFloat(d)<0&&(d=b);var e=a.style||a,f=d!==b;return!q.support.opacity&&c==="opacity"?(f&&(e.zoom=1,c=parseInt(d,10)+""=="NaN"?"":"alpha(opacity="+d*100+")",a=e.filter||q.curCSS(a,"filter")||"",e.filter=bs.test(a)?a.replace(bs,c):c),e.filter&&e.filter.indexOf("opacity=")>=0?parseFloat(bt.exec(e.filter)[1])/100+"":""):(bu.test(c)&&(c=bD),c=c.replace(bv,bE),f&&(e[c]=d),e[c])},css:function(a,b,c,d){if(b==="width"||b==="height"){var e,f=b==="width"?bA:bB;function g(){e=b==="width"?a.offsetWidth:a.offsetHeight,d!=="border"&&q.each(f,function(){d||(e-=parseFloat(q.curCSS(a,"padding"+this,!0))||0),d==="margin"?e+=parseFloat(q.curCSS(a,"margin"+this,!0))||0:e-=parseFloat(q.curCSS(a,"border"+this+"Width",!0))||0})}return a.offsetWidth!==0?g():q.swap(a,bz,g),Math.max(0,Math.round(e))}return q.curCSS(a,b,c)},curCSS:function(a,b,c){var d,e=a.style;if(!q.support.opacity&&b==="opacity"&&a.currentStyle)return d=bt.test(a.currentStyle.filter||"")?parseFloat(RegExp.$1)/100+"":"",d===""?"1":d;bu.test(b)&&(b=bD);if(!c&&e&&e[b])d=e[b];else if(bC){bu.test(b)&&(b="float"),b=b.replace(bw,"-$1").toLowerCase(),e=a.ownerDocument.defaultView;if(!e)return null;if(a=e.getComputedStyle(a,null))d=a.getPropertyValue(b);b==="opacity"&&d===""&&(d="1")}else if(a.currentStyle){c=b.replace(bv,bE),d=a.currentStyle[b]||a.currentStyle[c];if(!bx.test(d)&&by.test(d)){b=e.left;var f=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left,e.left=c==="fontSize"?"1em":d||0,d=e.pixelLeft+"px",e.left=b,a.runtimeStyle.left=f}}return d},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),q.expr&&q.expr.filters&&(q.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight,d=a.nodeName.toLowerCase()==="tr";return b===0&&c===0&&!d?!0:b>0&&c>0&&!d?!1:q.curCSS(a,"display")==="none"},q.expr.filters.visible=function(a){return!q.expr.filters.hidden(a)});var bF=f(),bG=/<script(.|\s)*?\/script>/gi,bH=/select|textarea/i,bI=/color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week/i,bJ=/=\?(&|$)/,bK=/\?/,bL=/(\?|&)_=.*?(&|$)/,bM=/^(\w+:)?\/\/([^\/?#]+)/,bN=/%20/g,bO=q.fn.load;q.fn.extend({load:function(a,b,c){if(typeof a!="string")return bO.call(this,a);if(!this.length)return this;var d=a.indexOf(" ");if(d>=0){var e=a.slice(d,a.length);a=a.slice(0,d)}d="GET",b&&(q.isFunction(b)?(c=b,b=null):typeof b=="object"&&(b=q.param(b,q.ajaxSettings.traditional),d="POST"));var f=this;return q.ajax({url:a,type:d,dataType:"html",data:b,complete:function(a,b){(b==="success"||b==="notmodified")&&f.html(e?q("<div />").append(a.responseText.replace(bG,"")).find(e):a.responseText),c&&f.each(c,[a.responseText,b,a])}}),this},serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?q.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bH.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){return a=q(this).val(),a==null?null:q.isArray(a)?q.map(a,function(a){return{name:b.name,value:a}}):{name:b.name,value:a}}).get()}}),q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){q.fn[b]=function(a){return this.bind(b,a)}}),q.extend({get:function(a,b,c,d){return q.isFunction(b)&&(d=d||c,c=b,b=null),q.ajax({type:"GET",url:a,data:b,success:c,dataType:d})},getScript:function(a,b){return q.get(a,null,b,"script")},getJSON:function(a,b,c){return q.get(a,b,c,"json")},post:function(a,b,c,d){return q.isFunction(b)&&(d=d||c,c=b,b={}),q.ajax({type:"POST",url:a,data:b,success:c,dataType:d})},ajaxSetup:function(a){q.extend(q.ajaxSettings,a)},ajaxSettings:{url:location.href,global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,xhr:a.XMLHttpRequest&&(a.location.protocol!=="file:"||!a.ActiveXObject)?function(){return new a.XMLHttpRequest}:function(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},etag:{},ajax:function(c){function d(){h.success&&h.success.call(l,k,j,v),h.global&&g("ajaxSuccess",[v,h])}function e(){h.complete&&h.complete.call(l,v,j),h.global&&g("ajaxComplete",[v,h]),h.global&&!--q.active&&q.event.trigger("ajaxStop")}function g(a,b){(h.context?q(h.context):q.event).trigger(a,b)}var h=q.extend(!0,{},q.ajaxSettings,c),i,j,k,l=c&&c.context||h,m=h.type.toUpperCase();h.data&&h.processData&&typeof h.data!="string"&&(h.data=q.param(h.data,h.traditional));if(h.dataType==="jsonp"){if(m==="GET")bJ.test(h.url)||(h.url+=(bK.test(h.url)?"&":"?")+(h.jsonp||"callback")+"=?");else if(!h.data||!bJ.test(h.data))h.data=(h.data?h.data+"&":"")+(h.jsonp||"callback")+"=?";h.dataType="json"}h.dataType==="json"&&(h.data&&bJ.test(h.data)||bJ.test(h.url))&&(i=h.jsonpCallback||"jsonp"+bF++,h.data&&(h.data=(h.data+"").replace(bJ,"="+i+"$1")),h.url=h.url.replace(bJ,"="+i+"$1"),h.dataType="script",a[i]=a[i]||function(c){k=c,d(),e(),a[i]=b;try{delete a[i]}catch(f){}p&&p.removeChild(r)}),h.dataType==="script"&&h.cache===null&&(h.cache=!1);if(h.cache===!1&&m==="GET"){var n=f(),o=h.url.replace(bL,"$1_="+n+"$2");h.url=o+(o===h.url?(bK.test(h.url)?"&":"?")+"_="+n:"")}h.data&&m==="GET"&&(h.url+=(bK.test(h.url)?"&":"?")+h.data),h.global&&!(q.active++)&&q.event.trigger("ajaxStart"),n=(n=bM.exec(h.url))&&(n[1]&&n[1]!==location.protocol||n[2]!==location.host);if(h.dataType==="script"&&m==="GET"&&n){var p=t.getElementsByTagName("head")[0]||t.documentElement,r=t.createElement("script");r.src=h.url,h.scriptCharset&&(r.charset=h.scriptCharset);if(!i){var s=!1;r.onload=r.onreadystatechange=function(){!s&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(s=!0,d(),e(),r.onload=r.onreadystatechange=null,p&&r.parentNode&&p.removeChild(r))}}return p.insertBefore(r,p.firstChild),b}var u=!1,v=h.xhr();if(v){h.username?v.open(m,h.url,h.async,h.username,h.password):v.open(m,h.url,h.async);try{(h.data||c&&c.contentType)&&v.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(q.lastModified[h.url]&&v.setRequestHeader("If-Modified-Since",q.lastModified[h.url]),q.etag[h.url]&&v.setRequestHeader("If-None-Match",q.etag[h.url])),n||v.setRequestHeader("X-Requested-With","XMLHttpRequest"),v.setRequestHeader("Accept",h.dataType&&h.accepts[h.dataType]?h.accepts[h.dataType]+", */*":h.accepts._default)}catch(w){}if(h.beforeSend&&h.beforeSend.call(l,v,h)===!1)return h.global&&!--q.active&&q.event.trigger("ajaxStop"),v.abort(),!1;h.global&&g("ajaxSend",[v,h]);var x=v.onreadystatechange=function(a){if(!v||v.readyState===0||a==="abort")u||e(),u=!0,v&&(v.onreadystatechange=q.noop);else if(!u&&v&&(v.readyState===4||a==="timeout")){u=!0,v.onreadystatechange=q.noop,j=a==="timeout"?"timeout":q.httpSuccess(v)?h.ifModified&&q.httpNotModified(v,h.url)?"notmodified":"success":"error";var b;if(j==="success")try{k=q.httpData(v,h.dataType,h)}catch(c){j="parsererror",b=c}j==="success"||j==="notmodified"?i||d():q.handleError(h,v,j,b),e(),a==="timeout"&&v.abort(),h.async&&(v=null)}};try{var y=v.abort;v.abort=function(){v&&y.call(v),x("abort")}}catch(z){}h.async&&h.timeout>0&&setTimeout(function(){v&&!u&&x("timeout")},h.timeout);try{v.send(m==="POST"||m==="PUT"||m==="DELETE"?h.data:null)}catch(A){q.handleError(h,v,null,A),e()}return h.async||x(),v}},handleError:function(a,b,c,d){a.error&&a.error.call(a.context||a,b,c,d),a.global&&(a.context?q(a.context):q.event).trigger("ajaxError",[b,a,d])},active:0,httpSuccess:function(a){try{return!a.status&&location.protocol==="file:"||a.status>=200&&a.status<300||a.status===304||a.status===1223||a.status===0}catch(b){}return!1},httpNotModified:function(a,b){var c=a.getResponseHeader("Last-Modified"),d=a.getResponseHeader("Etag");return c&&(q.lastModified[b]=c),d&&(q.etag[b]=d),a.status===304||a.status===0},httpData:function(a,b,c){var d=a.getResponseHeader("content-type")||"",e=b==="xml"||!b&&d.indexOf("xml")>=0;return a=e?a.responseXML:a.responseText,e&&a.documentElement.nodeName==="parsererror"&&q.error("parsererror"),c&&c.dataFilter&&(a=c.dataFilter(a,b)),typeof a=="string"&&(b==="json"||!b&&d.indexOf("json")>=0?a=q.parseJSON(a):(b==="script"||!b&&d.indexOf("javascript")>=0)&&q.globalEval(a)),a},param:function(a,c){function d(a,b){q.isArray(b)?q.each(b,function(b,f){c||/\[\]$/.test(a)?e(a,f):d(a+"["+(typeof f=="object"||q.isArray(f)?b:"")+"]",f)}):!c&&b!=null&&typeof b=="object"?q.each(b,function(b,c){d(a+"["+b+"]",c)}):e(a,b)}function e(a,b){b=q.isFunction(b)?b():b,f[f.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)}var f=[];c===b&&(c=q.ajaxSettings.traditional);if(q.isArray(a)||a.jquery)q.each(a,function(){e(this.name,this.value)});else for(var g in a)d(g,a[g]);return f.join("&").replace(bN,"+")}});var bP={},bQ=/toggle|show|hide/,bR=/^([+-]=)?([\d+-.]+)(.*)$/,bS,bT=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];q.fn.extend({show:function(a,b){if(a||a===0)return this.animate(o("show",3),a,b);a=0;for(b=this.length;a<b;a++){var c=q.data(this[a],"olddisplay");this[a].style.display=c||"";if(q.css(this[a],"display")==="none"){c=this[a].nodeName;var d;if(bP[c])d=bP[c];else{var e=q("<"+c+" />").appendTo("body");d=e.css("display"),d==="none"&&(d="block"),e.remove(),bP[c]=d}q.data(this[a],"olddisplay",d)}}a=0;for(b=this.length;a<b;a++)this[a].style.display=q.data(this[a],"olddisplay")||"";return this},hide:function(a,b){if(a||a===0)return this.animate(o("hide",3),a,b);a=0;for(b=this.length;a<b;a++){var c=q.data(this[a],"olddisplay");!c&&c!=="none"&&q.data(this[a],"olddisplay",q.css(this[a],"display"))}a=0;for(b=this.length;a<b;a++)this[a].style.display="none";return this},_toggle:q.fn.toggle,toggle:function(a,b){var c=typeof a=="boolean";return q.isFunction(a)&&q.isFunction(b)?this._toggle.apply(this,arguments):a==null||c?this.each(function(){var b=c?a:q(this).is(":hidden");q(this)[b?"show":"hide"]()}):this.animate(o("toggle",3),a,b),this},fadeTo:function(a,b,c){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c)},animate:function(a,b,c,d){var e=q.speed(b,c,d);return q.isEmptyObject(a)?this.each(e.complete):this[e.queue===!1?"each":"queue"](function(){var b=q.extend({},e),c,d=this.nodeType===1&&q(this).is(":hidden"),f=this;for(c in a){var g=c.replace(bv,bE);c!==g&&(a[g]=a[c],delete a[c],c=g);if(a[c]==="hide"&&d||a[c]==="show"&&!d)return b.complete.call(this);(c==="height"||c==="width")&&this.style&&(b.display=q.css(this,"display"),b.overflow=this.style.overflow),q.isArray(a[c])&&((b.specialEasing=b.specialEasing||{})[c]=a[c][1],a[c]=a[c][0])}return b.overflow!=null&&(this.style.overflow="hidden"),b.curAnim=q.extend({},a),q.each(a,function(c,e){var g=new q.fx(f,b,c);if(bQ.test(e))g[e==="toggle"?d?"show":"hide":e](a);else{var h=bR.exec(e),i=g.cur(!0)||0;if(h){e=parseFloat(h[2]);var j=h[3]||"px";j!=="px"&&(f.style[c]=(e||1)+j,i=(e||1)/g.cur(!0)*i,f.style[c]=i+j),h[1]&&(e=(h[1]==="-="?-1:1)*e+i),g.custom(i,e,j)}else g.custom(i,e,"")}}),!0})},stop:function(a,b){var c=q.timers;return a&&this.queue([]),this.each(function(){for(var a=c.length-1;a>=0;a--)c[a].elem===this&&(b&&c[a](!0),c.splice(a,1))}),b||this.dequeue(),this}}),q.each({slideDown:o("show",1),slideUp:o("hide",1),slideToggle:o("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(a,b){q.fn[a]=function(a,c){return this.animate(b,a,c)}}),q.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?a:{complete:c||!c&&b||q.isFunction(a)&&a,duration:a,easing:c&&b||b&&!q.isFunction(b)&&b};return d.duration=q.fx.off?0:typeof d.duration=="number"?d.duration:q.fx.speeds[d.duration]||q.fx.speeds._default,d.old=d.complete,d.complete=function(){d.queue!==!1&&q(this).dequeue(),q.isFunction(d.old)&&d.old.call(this)},d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig||(b.orig={})}}),q.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(q.fx.step[this.prop]||q.fx.step._default)(this),(this.prop==="height"||this.prop==="width")&&this.elem.style&&(this.elem.style.display="block")},cur:function(a){return this.elem[this.prop]==null||!!this.elem.style&&this.elem.style[this.prop]!=null?(a=parseFloat(q.css(this.elem,this.prop,a)))&&a>-1e4?a:parseFloat(q.curCSS(this.elem,this.prop))||0:this.elem[this.prop]},custom:function(a,b,c){function d(a){return e.step(a)}this.startTime=f(),this.start=a,this.end=b,this.unit=c||this.unit||"px",this.now=this.start,this.pos=this.state=0;var e=this;d.elem=this.elem,d()&&q.timers.push(d)&&!bS&&(bS=setInterval(q.fx.tick,13))},show:function(){this.options.orig[this.prop]=q.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),q(this.elem).show()},hide:function(){this.options.orig[this.prop]=q.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=f(),c=!0;if(a||b>=this.options.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),this.options.curAnim[this.prop]=!0;for(var d in this.options.curAnim)this.options.curAnim[d]!==!0&&(c=!1);if(c){this.options.display!=null&&(this.elem.style.overflow=this.options.overflow,a=q.data(this.elem,"olddisplay"),this.elem.style.display=a?a:this.options.display,q.css(this.elem,"display")==="none"&&(this.elem.style.display="block")),this.options.hide&&q(this.elem).hide();if(this.options.hide||this.options.show)for(var e in this.options.curAnim)q.style(this.elem,e,this.options.orig[e]);this.options.complete.call(this.elem)}return!1}return e=b-this.startTime,this.state=e/this.options.duration,a=this.options.easing||(q.easing.swing?"swing":"linear"),this.pos=q.easing[this.options.specialEasing&&this.options.specialEasing[this.prop]||a](this.state,e,0,1,this.options.duration),this.now=this.start+(this.end-this.start)*this.pos,this.update(),!0}},q.extend(q.fx,{tick:function(){for(var a=q.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||q.fx.stop()},stop:function(){clearInterval(bS),bS=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){q.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),q.expr&&q.expr.filters&&(q.expr.filters.animated=function(a){return q.grep(q.timers,function(b){return a===b.elem}).length}),q.fn.offset="getBoundingClientRect"in t.documentElement?function(a){var b=this[0];if(a)return this.each(function(b){q.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return q.offset.bodyOffset(b);var c=b.getBoundingClientRect(),d=b.ownerDocument;return b=d.body,d=d.documentElement
,{top:c.top+(self.pageYOffset||q.support.boxModel&&d.scrollTop||b.scrollTop)-(d.clientTop||b.clientTop||0),left:c.left+(self.pageXOffset||q.support.boxModel&&d.scrollLeft||b.scrollLeft)-(d.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(b){q.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return q.offset.bodyOffset(b);q.offset.initialize();var c=b.offsetParent,d=b,e=b.ownerDocument,f,g=e.documentElement,h=e.body;d=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var i=b.offsetTop,j=b.offsetLeft;(b=b.parentNode)&&b!==h&&b!==g;){if(q.offset.supportsFixedPosition&&d.position==="fixed")break;f=e?e.getComputedStyle(b,null):b.currentStyle,i-=b.scrollTop,j-=b.scrollLeft,b===c&&(i+=b.offsetTop,j+=b.offsetLeft,q.offset.doesNotAddBorder&&(!q.offset.doesAddBorderForTableAndCells||!/^t(able|d|h)$/i.test(b.nodeName))&&(i+=parseFloat(f.borderTopWidth)||0,j+=parseFloat(f.borderLeftWidth)||0),d=c,c=b.offsetParent),q.offset.subtractsBorderForOverflowNotVisible&&f.overflow!=="visible"&&(i+=parseFloat(f.borderTopWidth)||0,j+=parseFloat(f.borderLeftWidth)||0),d=f}if(d.position==="relative"||d.position==="static")i+=h.offsetTop,j+=h.offsetLeft;return q.offset.supportsFixedPosition&&d.position==="fixed"&&(i+=Math.max(g.scrollTop,h.scrollTop),j+=Math.max(g.scrollLeft,h.scrollLeft)),{top:i,left:j}},q.offset={initialize:function(){var a=t.body,b=t.createElement("div"),c,d,e,f=parseFloat(q.curCSS(a,"marginTop",!0))||0;q.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",a.insertBefore(b,a.firstChild),c=b.firstChild,d=c.firstChild,e=c.nextSibling.firstChild.firstChild,this.doesNotAddBorder=d.offsetTop!==5,this.doesAddBorderForTableAndCells=e.offsetTop===5,d.style.position="fixed",d.style.top="20px",this.supportsFixedPosition=d.offsetTop===20||d.offsetTop===15,d.style.position=d.style.top="",c.style.overflow="hidden",c.style.position="relative",this.subtractsBorderForOverflowNotVisible=d.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==f,a.removeChild(b),q.offset.initialize=q.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return q.offset.initialize(),q.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(q.curCSS(a,"marginTop",!0))||0,c+=parseFloat(q.curCSS(a,"marginLeft",!0))||0),{top:b,left:c}},setOffset:function(a,b,c){/static/.test(q.curCSS(a,"position"))&&(a.style.position="relative");var d=q(a),e=d.offset(),f=parseInt(q.curCSS(a,"top",!0),10)||0,g=parseInt(q.curCSS(a,"left",!0),10)||0;q.isFunction(b)&&(b=b.call(a,c,e)),c={top:b.top-e.top+f,left:b.left-e.left+g},"using"in b?b.using.call(a,c):d.css(c)}},q.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=/^body|html$/i.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(q.curCSS(a,"marginTop",!0))||0,c.left-=parseFloat(q.curCSS(a,"marginLeft",!0))||0,d.top+=parseFloat(q.curCSS(b[0],"borderTopWidth",!0))||0,d.left+=parseFloat(q.curCSS(b[0],"borderLeftWidth",!0))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||t.body;a&&!/^body|html$/i.test(a.nodeName)&&q.css(a,"position")==="static";)a=a.offsetParent;return a})}}),q.each(["Left","Top"],function(a,c){var d="scroll"+c;q.fn[d]=function(c){var e=this[0],f;return e?c!==b?this.each(function(){(f=p(this))?f.scrollTo(a?q(f).scrollLeft():c,a?c:q(f).scrollTop()):this[d]=c}):(f=p(e))?"pageXOffset"in f?f[a?"pageYOffset":"pageXOffset"]:q.support.boxModel&&f.document.documentElement[d]||f.document.body[d]:e[d]:null}}),q.each(["Height","Width"],function(a,c){var d=c.toLowerCase();q.fn["inner"+c]=function(){return this[0]?q.css(this[0],d,!1,"padding"):null},q.fn["outer"+c]=function(a){return this[0]?q.css(this[0],d,!1,a?"margin":"border"):null},q.fn[d]=function(a){var e=this[0];return e?q.isFunction(a)?this.each(function(b){var c=q(this);c[d](a.call(this,b,c[d]()))}):"scrollTo"in e&&e.document?e.document.compatMode==="CSS1Compat"&&e.document.documentElement["client"+c]||e.document.body["client"+c]:e.nodeType===9?Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]):a===b?q.css(e,d):this.css(d,typeof a=="string"?a:a+"px"):a==null?null:this}}),a.jQuery=a.$=q})(window),function($){$.toJSON=function(a){if(typeof JSON=="object"&&JSON.stringify)return JSON.stringify(a);var b=typeof a;if(a===null)return"null";if(b=="undefined")return undefined;if(b=="number"||b=="boolean")return a+"";if(b=="string")return $.quoteString(a);if(b=="object"){if(typeof a.toJSON=="function")return $.toJSON(a.toJSON());if(a.constructor===Date){var c=a.getUTCMonth()+1;c<10&&(c="0"+c);var d=a.getUTCDate();d<10&&(d="0"+d);var e=a.getUTCFullYear(),f=a.getUTCHours();f<10&&(f="0"+f);var g=a.getUTCMinutes();g<10&&(g="0"+g);var h=a.getUTCSeconds();h<10&&(h="0"+h);var i=a.getUTCMilliseconds();return i<100&&(i="0"+i),i<10&&(i="0"+i),'"'+e+"-"+c+"-"+d+"T"+f+":"+g+":"+h+"."+i+'Z"'}if(a.constructor===Array){var j=[];for(var k=0;k<a.length;k++)j.push($.toJSON(a[k])||"null");return"["+j.join(",")+"]"}var l=[];for(var m in a){var n,b=typeof m;if(b=="number")n='"'+m+'"';else{if(b!="string")continue;n=$.quoteString(m)}if(typeof a[m]=="function")continue;var o=$.toJSON(a[m]);l.push(n+":"+o)}return"{"+l.join(", ")+"}"}},$.evalJSON=function(src){return typeof JSON=="object"&&JSON.parse?JSON.parse(src):eval("("+src+")")},$.secureEvalJSON=function(src){if(typeof JSON=="object"&&JSON.parse)return JSON.parse(src);var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@"),filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(a){return a.match(_escapeable)?'"'+a.replace(_escapeable,function(a){var b=_meta[a];return typeof b=="string"?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,_meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}}(jQuery);var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b==-1)return;return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var TT=TT||{};TT.PAGE_WIDTH=800,TT.PAGE_HEIGHT=500,TT.PAGE_MIN_WIDTH=1e3,TT.PAGE_MIN_HEIGHT=680,TT.PAGE_MARGIN_X=32,TT.PAGE_MARGIN_Y=10,TT.BOOK_WIDTH=1660,TT.BOOK_HEIGHT=520,TT.BOOK_WIDTH_CLOSED=TT.BOOK_WIDTH/2,TT.BOOK_OFFSET_X=5,TT.UA=navigator.userAgent.toLowerCase(),TT.IS_TOUCH_DEVICE=TT.UA.match(/android/)||TT.UA.match(/iphone/)||TT.UA.match(/ipad/)||TT.UA.match(/ipod/),TT.initialize=function(){TT.preloader.initialize(),TT.overlay.initialize(),TT.storage.initialize(),TT.cache.initialize(),TT.search.initialize(),TT.chapternav.initialize(),TT.sharing.initialize(),TT.paperstack.initialize(),TT.tableofthings.initialize(),TT.flipintro.initialize(),$(window).resize(TT.onWindowResize),$(window).scroll(TT.onWindowScroll),TT.updateLayout(),$("img").mousedown(function(a){a.preventDefault()})},TT.startup=function(){TT.navigation.initialize(),TT.pageflip.initialize(),TT.history.initialize(),TT.locale.initialize(),TT.chapternav.updateSelection(),TT.tableofthings.updateSelection(),TT.chapternav.updateReadMarkers(),TT.tableofthings.updateReadMarkers(),TT.paperstack.updateStack(),TT.navigation.updateNextPrevLinks($("#pages section.current"))},TT.onWindowResize=function(a){TT.updateLayout()},TT.onWindowScroll=function(a){TT.updateLayout(!0)},TT.updateLayout=function(a){var b={width:$(window).width(),height:$(window).height()};$("body").css({overflowX:b.width<TT.PAGE_MIN_WIDTH?"auto":"hidden",overflowY:b.height<TT.PAGE_MIN_HEIGHT?"auto":"hidden"}),b.width=Math.max(b.width,TT.PAGE_MIN_WIDTH),b.height=Math.max(b.height,TT.PAGE_MIN_HEIGHT);var c={x:b.width*.5,y:b.height*.5};a||(b.width<TT.PAGE_MIN_WIDTH+$("#grey-mask").width()+50?$("#grey-mask").css({left:-(TT.PAGE_MIN_WIDTH+$("#grey-mask").width()+50-b.width)}):$("#grey-mask").css({left:0}),$("#book").css({left:c.x-TT.BOOK_WIDTH*.5-TT.BOOK_WIDTH_CLOSED*.5+TT.BOOK_OFFSET_X,top:c.y-TT.BOOK_HEIGHT*.5,margin:0}),$("#table-of-contents div.center").css({left:c.x-parseInt($("#table-of-contents div.center").innerWidth())*.5,top:c.y-parseInt($("#table-of-contents div.center").height())*.5,margin:0}),$("#table-of-contents, header, footer").css({width:b.width}),$("#credits").css({left:c.x-$("#credits").width()*.5,top:c.y-$("#credits").height()*.5,margin:0}),$("#overlay div.bookmark").css({left:c.x-$("#overlay div.bookmark").width()*.5,top:c.y-$("#overlay div.bookmark").height()*.5,margin:0}),$("footer").css({top:b.height-$("footer").height(),margin:0}),$("#search-dropdown").css({left:$("#search-field").position().left+1,top:$("#search-field").position().top+$("#search-field").height()+2}),$("#chapter-nav").css({left:c.x-$("#chapter-nav").width()*.5+5+TT.BOOK_OFFSET_X,top:$("footer").position().top-$("#chapter-nav").outerHeight()+5})),$("#pagination-prev, #pagination-next").css({top:c.y-20}),TT.IS_TOUCH_DEVICE||($("#pagination-prev").css({left:$(window).scrollLeft()}),$("#pagination-next").css({right:"auto",left:$(window).scrollLeft()+$(window).width()-$("#pagination-next").width()}))},TT.log=function(a){window.console&&a&&window.console.log(a)},TT.lights=function(){return $("footer div.lights a").click(function(a){a.preventDefault(),$("html").hasClass("dark")?($(this).parent().removeClass("clone").appendTo("footer .lights-wrapper"),setTimeout(function(){$("div.lights .icon").removeClass("off")},0)):($(this).parent().addClass("clone").appendTo("body"),setTimeout(function(){$("div.lights .icon").addClass("off")},0)),$("html,body").toggleClass("dark")}),$(".dark footer").live("hover",function(){$("div.lights").toggleClass("active")}),{turnOn:function(){$("html,body").removeClass("dark"),$("div.lights").removeClass("clone").appendTo("footer .lights-wrapper"),$("div.lights .icon").removeClass("off")}}}(),TT.fullscreen=function(){function a(){$("div.fullscreen").addClass("clone").appendTo("body"),$("div.fullscreen .icon").addClass("off"),TT.pageflip.unregisterEventListeners(),TT.updateLayout(),TT.lights.turnOn()}function b(){$("div.fullscreen").removeClass("clone").appendTo("footer .fullscreen-wrapper"),$("div.fullscreen .icon").removeClass("off"),TT.pageflip.registerEventListeners(),TT.updateLayout()}return $("footer div.fullscreen a").click(function(c){c.preventDefault(),$("html,body").toggleClass("fullscreen"),$("html").hasClass("fullscreen")?a():b()}),$("footer .fullscreen-wrapper").show(),{exit:function(){$("html,body").removeClass("fullscreen"),b()}}}(),TT.time=function(){return(new Date).getTime()},TT.track=function(a){_gaq.push(["_trackPageview",a])},window.TT=TT,TT.preloader={},TT.preloader.assetsComplete=!1,TT.preloader.contentsComplete=!1,TT.preloader.finished=!1,TT.preloader.assetsLoaded=0,TT.preloader.assetsToLoad=0,TT.preloader.initialize=function(){TT.preloader.animation.initialize(),TT.preloader.animation.activate(),TT.preloader.assetsToLoad=9;var a=new Image,b=new Image,c=new Image,d=new Image,e=new Image,f=new Image,g=new Image,h=new Image,i=new Image;TT.preloader.addAssetToPreloadQueue($(a)),TT.preloader.addAssetToPreloadQueue($(b)),TT.preloader.addAssetToPreloadQueue($(c)),TT.preloader.addAssetToPreloadQueue($(d)),TT.preloader.addAssetToPreloadQueue($(e)),TT.preloader.addAssetToPreloadQueue($(f)),TT.preloader.addAssetToPreloadQueue($(g)),TT.preloader.addAssetToPreloadQueue($(h)),TT.preloader.addAssetToPreloadQueue($(i)),$("#preloader .contents").delay(50).animate({opacity:1},300);var j="?v=1";a.src="../../img/wordbook/sprites.png"+j,b.src="../../img/wordbook/front-cover.jpg"+j,c.src="../../img/wordbook/back-cover.jpg"+j,d.src="../../img/wordbook/right-page.jpg"+j,e.src="../../img/wordbook/left-page.jpg"+j,f.src="../../img/wordbook/repeat-x.png"+j,g.src="../../img/wordbook/right-page-paper.jpg"+j,h.src="../../img/wordbook/left-page-flipped.jpg"+j,i.src="../../img/wordbook/back-cover-flipped.jpg"+j},TT.preloader.updateMeter=function(){var a=TT.preloader.assetsToLoad,b=TT.preloader.assetsLoaded;TT.preloader.contentsComplete&&b++;var c=Math.min(b/a,1),d=c*$("#preloader .progress").width();$("#preloader .progress .fill").width(d)},TT.preloader.addAssetToPreloadQueue=function(a){a.load(TT.preloader.onAssetLoaded),a.error(TT.preloader.onAssetLoaded)},TT.preloader.onAssetLoaded=function(a){++TT.preloader.assetsLoaded>=TT.preloader.assetsToLoad&&TT.preloader.onAllAssetsLoaded(),TT.log("Asset preloaded: "+$(a.target).attr("src")+" ["+TT.preloader.assetsLoaded+"/"+TT.preloader.assetsToLoad+"]"),TT.preloader.updateMeter()},TT.preloader.onAllAssetsLoaded=function(){!TT.preloader.assetsComplete&&TT.preloader.assetsLoaded>=TT.preloader.assetsToLoad&&(TT.preloader.assetsComplete=!0,TT.preloader.finish()),TT.preloader.updateMeter()},TT.preloader.onContentsLoaded=function(){TT.preloader.contentsComplete||(TT.preloader.contentsComplete=!0,TT.preloader.finish()),TT.preloader.updateMeter()},TT.preloader.finish=function(){TT.preloader.contentsComplete&&TT.preloader.assetsComplete&&!TT.preloader.finished&&($("#preloader").stop(!0,!0).fadeOut(200,function(){TT.preloader.animation.deactivate(),$(this).remove()}),$("#book").css({opacity:0}).show().delay(200).fadeTo(700,1),TT.updateLayout(),TT.startup(),setTimeout(TT.preloader.loadIllustrations,3e3),TT.preloader.finished=!0),TT.preloader.updateMeter()},TT.preloader.loadIllustrations=function(){$("div.page").find("img").each(function(){$(this).attr("src")!==$(this).attr("data-src")&&$(this).attr("src",$(this).attr("data-src"))})},TT.preloader.animation={},TT.preloader.animation.loopInterval=-1,TT.preloader.animation.WIDTH=89,TT.preloader.animation.HEIGHT=29,TT.preloader.animation.VSPACE=20,TT.preloader.animation.canvas=null,TT.preloader.animation.context=null,TT.preloader.animation.flip={progress:0,alpha:0},TT.preloader.animation.initialize=function(){this.canvas=$("#preloader .animation"),this.canvas[0]&&(this.canvas[0].width=this.WIDTH,this.canvas[0].height=this.HEIGHT+this.VSPACE*2,this.context=this.canvas[0].getContext("2d"))},TT.preloader.animation.activate=function(){TT.preloader.animation.loopInterval==-1&&(TT.preloader.animation.flip.progress=1,TT.preloader.animation.loopInterval=setInterval(function(){TT.preloader.animation.canvas[0]&&TT.preloader.animation.render()},32))},TT.preloader.animation.deactivate=function(){clearInterval(TT.preloader.animation.loopInterval),TT.preloader.animation.loopInterval=-1},TT.preloader.animation.render=function(){this.context.clearRect(0,0,this.WIDTH,this.HEIGHT+this.VSPACE*2),this.context.save(),this.context.translate(0,this.VSPACE),this.context.fillStyle="#f4f4f4",this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle="#999999",this.context.fillRect(0,0,this.WIDTH,1),this.context.fillRect(0,this.HEIGHT,this.WIDTH,2),this.context.fillRect(0,0,1,this.HEIGHT),this.context.fillRect(this.WIDTH-1,0,1,this.HEIGHT),this.context.fillRect(Math.floor(this.WIDTH*.5),0,1,this.HEIGHT),this.context.fillRect(54,8,25,2),this.context.fillRect(54,11,25,2),this.context.fillRect(54,14,25,2),this.context.fillRect(54,17,25,2),this.context.fillRect(54,20,25,2),this.context.translate(0,1),TT.preloader.animation.flip.progress-=Math.max(.12*(1-Math.abs(TT.preloader.animation.flip.progress)),.02),TT.preloader.animation.flip.alpha=1-(Math.abs(TT.preloader.animation.flip.progress)-.7)/.3,TT.preloader.animation.flip.progress<=-1.1&&(TT.preloader.animation.flip.progress=1);var a=1-Math.abs(TT.preloader.animation.flip.progress),b=a*12,c=a*8,d={top:{x:this.WIDTH*.5,y:0},bottom:{x:this.WIDTH*.5,y:this.HEIGHT}},e={top:{x:d.top.x+this.WIDTH*TT.preloader.animation.flip.progress*.55,y:0-b},bottom:{x:d.bottom.x+this.WIDTH*TT.preloader.animation.flip.progress*.55,y:this.HEIGHT-b}},f={top:{x:d.top.x+12*TT.preloader.animation.flip.progress,y:-c},bottom:{x:d.bottom.x+12*TT.preloader.animation.flip.progress,y:this.HEIGHT-c}};this.context.fillStyle="rgba(245,245,245,"+TT.preloader.animation.flip.alpha+")",this.context.strokeStyle="rgba(90,90,90,"+TT.preloader.animation.flip.alpha+")",this.context.beginPath(),this.context.moveTo(d.top.x,d.top.y),this.context.quadraticCurveTo(f.top.x,f.top.y,e.top.x,e.top.y),this.context.lineTo(e.bottom.x,e.bottom.y),this.context.quadraticCurveTo(f.bottom.x,f.bottom.y,d.bottom.x,d.bottom.y),this.context.fill(),this.context.stroke(),this.context.restore()},TT.history={},TT.history.TABLE_OF_CONTENTS="table-of-things",TT.history.HOME="home",TT.history.FOREWORD="foreword",TT.history.THEEND="theend",TT.history.CREDITS="credits",TT.history.previousHash="",TT.history.hashCheckInterval=-1,TT.history.initialize=function(){TT.history.supportsHistoryPushState()?$(window).bind("popstate",TT.history.onPopState):TT.history.hashCheckInterval=setInterval(TT.history.onCheckHash,200)},TT.history.supportsHistoryPushState=function(){return"pushState"in window.history&&window.history.pushState!==null},TT.history.onCheckHash=function(){document.location.hash!==TT.history.previousHash&&(TT.history.navigateToPath(document.location.hash.slice(1)),TT.history.previousHash=document.location.hash)},TT.history.pushState=function(a){TT.history.supportsHistoryPushState()||(TT.history.previousHash="#"+a,document.location.hash=a)},TT.history.onPopState=function(a){TT.history.navigateToPath(document.location.pathname)},TT.history.navigateToPath=function(a){a=TT.locale.removeLocaleCodeFromURL(a);var b=a.split("/")[1],c=a.split("/")[2];!b||b==TT.history.HOME?TT.navigation.goToHome(!0):b==TT.history.CREDITS?TT.navigation.goToCredits(!0):b==TT.history.TABLE_OF_CONTENTS?TT.tableofthings.show():c?TT.navigation.goToPage(b,c,!0):TT.navigation.goToPage(b,"1",!0)},TT.storage={},TT.storage.isFirstTimeVisitor=!0,TT.storage.contents="",TT.storage.data={articles:{},progress:{},bookmark:{articleId:"",pageNumber:""}},TT.storage.initialize=function(){TT.storage.routeDataRequest()},TT.storage.load=function(){TT.storage.supportsLocalStorage()&&localStorage.data&&(TT.storage.data=$.parseJSON(localStorage.data))},TT.storage.save=function(){TT.storage.supportsLocalStorage()&&(localStorage.data=$.toJSON(TT.storage.data))},TT.storage.supportsLocalStorage=function(){return"localStorage"in window&&window.localStorage!==null},TT.storage.getArticlesFromServer=function(){TT.log("Getting articles from server");var a=TT.chapternav.getDisabledArticles();$.ajax({url:"/"+SERVER_VARIABLES.LANG+"/all",contentType:"text/html;charset=UTF-8",success:function(b){var c=0;TT.storage.data.articles={},$(b).each(function(){var b=$(this).attr("id");$(this).find("section").each(function(d){c++,$(this).addClass("globalPage-"+c).css("zIndex",500-c).hide(),TT.storage.supportsLocalStorage()&&(TT.storage.data.articles["/"+b+"/"+(d+1)]=$("<div>").append($(this).clone()).remove().html());var e=!1;for(var d=0;d<a.length;d++)a[d]==b&&(e=!0);e==0&&$("#pages").append($("<div>").append($(this).clone()).remove().html())})}),TT.storage.save(),TT.storage.onFindBookmark(),TT.storage.activateCurrentPageAndSetPageCount()}})},TT.storage.getArticlesFromServerTranslated=function(){TT.log("getting articles from server");var a=TT.chapternav.getDisabledArticles();$.ajax({url:"/all",contentType:"text/html;charset=UTF-8",success:function(b){var c=0;TT.storage.data.articles={},$(b).each(function(){var b=$(this).attr("id");$(this).find("section").each(function(d){c++,$(this).addClass("globalPage-"+c).css("zIndex",500-c).hide(),TT.storage.supportsLocalStorage()&&(TT.storage.data.articles["/"+b+"/"+(d+1)]=$("<div>").append($(this).clone()).remove().html());var e=!1;for(var d=0;d<a.length;d++)a[d]==b&&(e=!0);e==0&&$("#pages").append($("<div>").append($(this).clone()).remove().html())})}),TT.storage.save(),TT.storage.onFindBookmark(),TT.storage.activateCurrentPageAndSetPageCount()}})},TT.storage.getArticlesFromStorage=function(){TT.log("Getting articles from storage"),TT.storage.isFirstTimeVisitor=!1;if(!localStorage.data){TT.storage.getArticlesFromServer();return}TT.storage.data=$.parseJSON(localStorage.data);var a=TT.chapternav.getDisabledArticles();for(var b in TT.storage.data.articles){var c=!1;for(var d=0;d<a.length;d++)a[d]==b.split("/")[1]&&(c=!0);c==0&&$("#pages").append(TT.storage.data.articles[b])}TT.storage.onFindBookmark(),TT.storage.activateCurrentPageAndSetPageCount()},TT.storage.routeDataRequest=function(){TT.storage.supportsLocalStorage()?(TT.log("Version on server is: "+SERVER_VARIABLES.SITE_VERSION),SERVER_VARIABLES.SITE_VERSION!=localStorage.version||SERVER_VARIABLES.LANG!=localStorage.lang?(localStorage.version=SERVER_VARIABLES.SITE_VERSION,localStorage.lang=SERVER_VARIABLES.LANG,TT.storage.getArticlesFromServer()):TT.storage.getArticlesFromStorage()):TT.storage.getArticlesFromServer()},TT.storage.activateCurrentPageAndSetPageCount=function(){var a=$("#pages section").eq(0);a.attr("id","original"),$("#pages section:not(#original)").each(function(b){$(this).hasClass(a.attr("class"))&&(a.remove(),$(this).addClass("current").show().next("section").show(),$('<span id="currentPage">'+parseFloat(b+1)+"</span>").appendTo("body"))}),$("#pages section.current").length===0&&$("#pages section").first().addClass("current"),$("#pages section div.page").each(function(a){$(this).append('<span class="pageNumber">'+(a+1)+"</span>")}),$("body").hasClass("home")?($("#pages section").removeClass("current"),$("#pages section").first().addClass("current")):$("body").hasClass("credits")&&($("#pages section").removeClass("current"),$("#pages section").last().addClass("current")),TT.preloader.onContentsLoaded()},TT.storage.onFindBookmark=function(){TT.storage.supportsLocalStorage()&&(TT.storage.data.bookmark.articleId&&$("#pagination-prev").hasClass("inactive")&&(TT.storage.data.bookmark.articleId!=$("#articleId").text()||TT.storage.data.bookmark.pageNumber!=$("#pageNumber").text())?(TT.log("Bookmark found: "+TT.storage.data.bookmark.articleId+"/"+TT.storage.data.bookmark.pageNumber),TT.overlay.showBookmark(function(){TT.navigation.goToPage(TT.storage.data.bookmark.articleId,TT.storage.data.bookmark.pageNumber)},function(){TT.navigation.goToHome()},function(){TT.storage.setBookmark($("#articleId").text(),$("#pageNumber").text())}),TT.log("Bookmark found: "+TT.storage.data.bookmark.articleId+"/"+TT.storage.data.bookmark.pageNumber)):TT.storage.setBookmark($("#articleId").text(),$("#pageNumber").text()))},TT.storage.setBookmark=function(a,b){TT.storage.supportsLocalStorage()&&a!=TT.history.THEEND&&(TT.storage.data.bookmark.articleId=a,TT.storage.data.bookmark.pageNumber=b,TT.storage.data.progress["/"+a+"/"+b]=!0,TT.storage.save(),TT.chapternav.updateReadMarkers(),TT.tableofthings.updateReadMarkers())},TT.storage.hasArticleBeenRead=function(a){return TT.storage.data.progress["/"+a+"/1"]==1},TT.pageflip={},TT.pageflip.HINT_WIDTH=100,TT.pageflip.HINT_WIDTH_TOUCH=250,TT.pageflip.CANVAS_VERTICAL_PADDING=80,TT.pageflip.CANVAS_HORIZONTAL_PADDING=20,TT.pageflip.CANVAS_WIDTH=TT.BOOK_WIDTH+TT.pageflip.CANVAS_HORIZONTAL_PADDING*2,TT.pageflip.CANVAS_HEIGHT=TT.BOOK_HEIGHT+TT.pageflip.CANVAS_VERTICAL_PADDING*2,TT.pageflip.FRAMERATE=30,TT.pageflip.CLICK_FREQUENCY=350,TT.pageflip.SOFT_FLIP="soft",TT.pageflip.HARD_FLIP="hard",TT.pageflip.pages=[],TT.pageflip.flips=[],TT.pageflip.canvas=null,TT.pageflip.context=null,TT.pageflip.dirtyRegion=new Region,TT.pageflip.dragging=!1,TT.pageflip.turning=!1,TT.pageflip.hinting=!1,TT.pageflip.loopInterval=-1,TT.pageflip.mouse={x:0,y:0,down:!1},TT.pageflip.mouseHistory=[],TT.pageflip.skew={top:0,topTarget:0,bottom:0,bottomTarget:0},TT.pageflip.mouseDownTime=0,TT.pageflip.texture=null,TT.pageflip.textures={},TT.pageflip.flippedLeftPage=null,TT.pageflip.flippedBackCover=null,TT.pageflip.lastKeyboardNavigationTime=0,TT.pageflip.lastKeyboardNavigationDirection=null,TT.pageflip.eventsAreBound=null,TT.pageflip.initialize=function(){TT.pageflip.createCanvas(),TT.pageflip.createTextures(),TT.pageflip.eventsAreBound==null&&TT.pageflip.registerEventListeners(),$(document).bind("keydown",TT.pageflip.onKeyPress)},TT.pageflip.registerEventListeners=function(){TT.pageflip.unregisterEventListeners(),TT.pageflip.eventsAreBound=!0,$(document).bind("mousemove",TT.pageflip.onMouseMove),$(document).bind("mousedown",TT.pageflip.onMouseDown),$(document).bind("mouseup",TT.pageflip.onMouseUp),TT.IS_TOUCH_DEVICE&&(document.addEventListener("touchstart",TT.pageflip.onTouchStart,!1),document.addEventListener("touchmove",TT.pageflip.onTouchMove,!1),document.addEventListener("touchend",TT.pageflip.onTouchEnd,!1))},TT.pageflip.unregisterEventListeners=function(){TT.pageflip.eventsAreBound=!1,$(document).unbind("mousemove",TT.pageflip.onMouseMove),$(document).unbind("mousedown",TT.pageflip.onMouseDown),$(document).unbind("mouseup",TT.pageflip.onMouseUp),TT.IS_TOUCH_DEVICE&&(document.removeEventListener("touchstart",TT.pageflip.onTouchStart),document.removeEventListener("touchmove",TT.pageflip.onTouchMove),document.removeEventListener("touchend",TT.pageflip.onTouchEnd))},TT.pageflip.createTextures=function(){TT.pageflip.flippedLeftPage=$("<img>",{src:$("#left-page img").attr("data-src-flipped"),width:$("#left-page img").attr("width"),height:$("#left-page img").attr("height")})[0],TT.pageflip.flippedBackCover=$("<img>",{src:$("#back-cover img").attr("data-src-flipped"),width:$("#back-cover img").attr("width"),height:$("#back-cover img").attr("height")})[0],TT.pageflip.textures.front=$("#front-cover img")[0],TT.pageflip.textures.back=TT.pageflip.flippedBackCover,TT.pageflip.textures.left=TT.pageflip.flippedLeftPage,TT.pageflip.textures.right=$("#right-page img")[0]},TT.pageflip.createCanvas=function(){TT.pageflip.canvas=$('<canvas id="pageflip"></canvas>'),TT.pageflip.canvas.css({position:"absolute",top:-TT.pageflip.CANVAS_VERTICAL_PADDING,left:-TT.pageflip.CANVAS_HORIZONTAL_PADDING,zIndex:0}),TT.pageflip.canvas[0].width=TT.pageflip.CANVAS_WIDTH,TT.pageflip.canvas[0].height=TT.pageflip.CANVAS_HEIGHT,TT.pageflip.context=TT.pageflip.canvas[0].getContext("2d"),TT.pageflip.canvas.appendTo($("#book"))},TT.pageflip.createCanvasTexture=function(a,b,c,d){var e=$("<canvas></canvas>");e.css({position:"absolute",display:"block"}),e[0].width=TT.BOOK_WIDTH_CLOSED,e[0].height=TT.BOOK_HEIGHT;var f=e[0].getContext("2d");return f.translate(b.x,b.y),f.scale(c.x,c.y),f.rotate(d),f.drawImage(a,0,0),e[0]},TT.pageflip.activate=function(){TT.pageflip.loopInterval==-1&&(clearInterval(TT.pageflip.loopInterval),TT.pageflip.loopInterval=setInterval(TT.pageflip.redraw,1e3/TT.pageflip.FRAMERATE)),TT.pageflip.canvas.css("z-index",1010)},TT.pageflip.deactivate=function(){clearInterval(TT.pageflip.loopInterval),TT.pageflip.loopInterval=-1,TT.pageflip.context.clearRect(0,0,TT.pageflip.CANVAS_WIDTH,TT.pageflip.CANVAS_HEIGHT),TT.pageflip.canvas.css("z-index",0)},TT.pageflip.redraw=function(){var a=TT.pageflip.canvas[0],b=TT.pageflip.context,c=TT.pageflip.dirtyRegion.toRectangle(40);c.width>1&&c.height>1&&b.clearRect(c.x,c.y,c.width,c.height),TT.pageflip.dirtyRegion.reset();for(var d=0,e=TT.pageflip.flips.length;d<e;d++){var f=TT.pageflip.flips[d];f.type==TT.pageflip.HARD_FLIP?TT.pageflip.renderHardFlip(f):TT.pageflip.renderSoftFlip(f)}TT.pageflip.removeInactiveFlips()},TT.pageflip.renderSoftFlip=function(a){var b=TT.pageflip.mouse,c=TT.pageflip.skew,d=TT.pageflip.canvas[0],e=TT.pageflip.context,f=a.currentPage;a.direction===-1?f=a.targetPage:a.targetPage.width(TT.PAGE_WIDTH);if(TT.pageflip.dragging&&!a.consumed)b.x=Math.max(Math.min(b.x,TT.PAGE_WIDTH),-TT.PAGE_WIDTH),b.y=Math.max(Math.min(b.y,TT.PAGE_HEIGHT),0),a.progress=Math.min(b.x/TT.PAGE_WIDTH,1);else{var g=Math.abs(a.target-a.progress),h=a.target==-1?.3:.2,i=g<1?h+Math.abs(a.progress*(1-h)):h;i*=Math.max(1-Math.abs(a.progress),a.target==1?.5:.2),a.progress+=(a.target-a.progress)*i;if(Math.round(a.progress*99)==Math.round(a.target*99)){a.progress=a.target,a.x=TT.PAGE_WIDTH*a.progress,f.css({width:a.x});if(a.target==1||a.target==-1)return a.consumed=!0,TT.pageflip.completeCurrentTurn(),!1}}a.x=TT.PAGE_WIDTH*a.progress,a.strength=1-a.x/TT.PAGE_WIDTH,a.target==-1&&a.progress<-0.9&&(a.alpha=1-(Math.abs(a.progress)-.9)/.1);var j=Math.min(1-(Math.abs(a.progress)-.75)/.25,1),k=a.strength>1?2-a.strength:a.strength,l=40*k,m=TT.PAGE_WIDTH*.5*a.strength*.95;a.x+m<0&&(m=Math.abs(a.x)),TT.navigation.isCreditsPage()&&(m=0);var n=TT.PAGE_WIDTH*.5*Math.max(Math.min(a.strength,.5),0),o=TT.PAGE_WIDTH*.5*Math.max(Math.min(a.strength,.5),0),p=TT.PAGE_WIDTH*.5*Math.max(Math.min(k,.5),0),q=TT.PAGE_WIDTH*.9*Math.max(Math.min(a.strength,.05),0);f.css({width:Math.max(a.x+m*.5,0)}),TT.pageflip.dragging?(c.topTarget=Math.max(Math.min(b.y/(TT.PAGE_HEIGHT*.5),1),0)*40*k,c.bottomTarget=Math.max(Math.min(1-(b.y-TT.PAGE_HEIGHT*.5)/(TT.PAGE_HEIGHT*.5),1),0)*40*k):(c.topTarget=0,c.bottomTarget=0),a.progress===1&&(c.top=0,c.bottom=0),c.top+=(c.topTarget-c.top)*.3,c.bottom+=(c.bottomTarget-c.bottom)*.3,a.x+=m;var r={x:TT.pageflip.CANVAS_HORIZONTAL_PADDING+TT.PAGE_MARGIN_X+TT.PAGE_WIDTH,y:TT.pageflip.CANVAS_VERTICAL_PADDING+TT.PAGE_MARGIN_Y};e.save(),e.translate(r.x,r.y),e.globalAlpha=a.alpha,a.direction==-1&&(e.globalCompositeOperation="destination-over"),e.strokeStyle="rgba(0,0,0,0.1)",e.lineWidth=.5,e.beginPath(),e.moveTo(a.x+1,0),e.lineTo(a.x+1,TT.PAGE_HEIGHT),e.stroke();var s=e.createLinearGradient(a.x-n,0,a.x,0);s.addColorStop(.35,"#fafafa"),s.addColorStop(.73,"#eeeeee"),s.addColorStop(.9,"#fafafa"),s.addColorStop(1,"#e2e2e2"),e.fillStyle=s,e.strokeStyle="rgba(0,0,0,0.1)",e.lineWidth=.5,e.beginPath(),e.moveTo(a.x,0),e.lineTo(a.x,TT.PAGE_HEIGHT),e.quadraticCurveTo(a.x,TT.PAGE_HEIGHT+l*1.9,a.x-m+c.bottom,TT.PAGE_HEIGHT+l),e.lineTo(a.x-m+c.top,-l),e.quadraticCurveTo(a.x,-l*1.9,a.x,0),e.fill(),e.stroke(),e.beginPath(),e.strokeStyle="rgba(0,0,0,"+.04*j+")",e.lineWidth=20*j,e.beginPath(),e.moveTo(a.x+c.top-m,-l*.5),e.lineTo(a.x+c.bottom-m,TT.PAGE_HEIGHT+l*.5),e.stroke();var t=e.createLinearGradient(a.x,0,a.x+o,0);t.addColorStop(0,"rgba(0,0,0,"+j*.1+")"),t.addColorStop(.8,"rgba(0,0,0,0.0)"),e.save(),e.globalCompositeOperation="destination-over",e.fillStyle=t,e.beginPath(),e.moveTo(a.x,0),e.lineTo(a.x+o,0),e.lineTo(a.x+o,TT.PAGE_HEIGHT),e.lineTo(a.x,TT.PAGE_HEIGHT),e.fill();var u=e.createLinearGradient(a.x,0,a.x+q,0);u.addColorStop(0,"rgba(0,0,0,"+j*.15+")"),u.addColorStop(1,"rgba(0,0,0,0.0)"),e.fillStyle=u,e.beginPath(),e.moveTo(a.x,0),e.lineTo(a.x+q,0),e.lineTo(a.x+q,TT.PAGE_HEIGHT),e.lineTo(a.x,TT.PAGE_HEIGHT),e.fill(),e.restore();var v=e.createLinearGradient(a.x-m-p,0,a.x-m,0);v.addColorStop(0,"rgba(0,0,0,0.0)"),v.addColorStop(1,"rgba(0,0,0,"+
j*.05+")"),e.fillStyle=v,e.beginPath(),e.moveTo(a.x-m+c.top-p,0),e.lineTo(a.x-m+c.top,0),e.lineTo(a.x-m+c.bottom,TT.PAGE_HEIGHT),e.lineTo(a.x-m+c.bottom-p,TT.PAGE_HEIGHT),e.fill(),e.restore(),TT.pageflip.dirtyRegion.inflate(TT.PAGE_WIDTH+TT.pageflip.CANVAS_HORIZONTAL_PADDING+a.x-m-p,0),TT.pageflip.dirtyRegion.inflate(TT.PAGE_WIDTH+TT.pageflip.CANVAS_HORIZONTAL_PADDING+a.x+o,TT.pageflip.CANVAS_HEIGHT)},TT.pageflip.renderHardFlip=function(a){var b=TT.pageflip.mouse,c=TT.pageflip.skew,d=TT.pageflip.canvas[0],e=TT.pageflip.context,f=a.currentPage;a.direction===-1&&(f=a.targetPage);if(TT.pageflip.dragging)b.x=Math.max(Math.min(b.x,TT.PAGE_WIDTH),-TT.PAGE_WIDTH),b.y=Math.max(Math.min(b.y,TT.PAGE_HEIGHT),0),a.target=b.x/TT.PAGE_WIDTH,a.progress+=(a.target-a.progress)*.4;else{Math.abs(a.target)===1?(a.progress+=Math.max(.5*(1-Math.abs(a.progress)),.02)*(a.target<a.progress?-1:1),a.progress=Math.max(Math.min(a.progress,1),-1)):a.progress+=(a.target-a.progress)*.4;if(a.progress===1||a.progress===-1){a.progress=a.target,a.x=TT.PAGE_WIDTH*a.progress,TT.navigation.isCreditsPage()&&f.width(a.x);if(a.target==1||a.target==-1)a.consumed=!0,TT.pageflip.completeCurrentTurn()}}TT.navigation.isHomePage()?(a.progress>.99?($("#front-cover-bookmark").stop(!0,!0).fadeIn(300),$("#front-cover").show()):($("#front-cover").hide(),a.progress<.99&&$("#front-cover-bookmark").fadeOut(250,function(){$(this).hide()})),a.progress>0?(TT.pageflip.texture=TT.pageflip.textures.front,$("#left-page").width(0).hide()):(TT.pageflip.texture=TT.pageflip.textures.left,a.progress<-0.99?$("#left-page").show().width(TT.BOOK_WIDTH_CLOSED):($("#left-page").width(0).hide(),$("#right-page").show())),$("#page-shadow-overlay").stop(!0,!0).fadeTo(.1,a.progress*.3)):TT.navigation.isCreditsPage()||TT.navigation.isLastPage()?(a.progress<-0.998?TT.navigation.isCreditsPage()?$("#back-cover").show():$("#left-page").show().width(TT.BOOK_WIDTH_CLOSED):($("#back-cover").hide(),$("body").addClass("credits")),a.progress>0?(TT.pageflip.texture=TT.pageflip.textures.right,a.progress>.996?($("#right-page").show(),$("body").removeClass("credits")):$("#right-page").hide()):TT.pageflip.texture=TT.pageflip.textures.back):($("#right-page").show(),$("#left-page").show().width(TT.BOOK_WIDTH_CLOSED)),a.target==-1&&a.progress<-0.95&&(a.alpha=1-(Math.abs(a.progress)-.95)/.05),a.x=TT.PAGE_WIDTH*a.progress,a.strength=1-a.x/TT.PAGE_WIDTH;var g=a.strength>1?2-a.strength:a.strength;(TT.navigation.isCreditsPage()||TT.navigation.isLastPage())&&f.css({width:Math.max(a.x,0)}),e.save(),e.translate(TT.pageflip.CANVAS_HORIZONTAL_PADDING+TT.BOOK_WIDTH_CLOSED,TT.pageflip.CANVAS_VERTICAL_PADDING);var h=a.progress,i=0,j=.35,k=1+1*j*g,l=TT.BOOK_WIDTH_CLOSED,m=TT.BOOK_HEIGHT,n=Math.round(40+30*(.9999-TT.BOOK_WIDTH_CLOSED*h/TT.BOOK_WIDTH_CLOSED));n=Math.min(l,n);var o=l/n,p=10*g,q=a.progress<=.05?1+(1-Math.max(a.progress,0)/.05)*-p:-1,r={left:Math.abs(Math.min(a.progress,0))*2,right:a.progress*2};if(Math.abs(h)<.99){var s=(m-m*k)/2;e.fillStyle=SERVER_VARIABLES.SOLID_BOOK_COLOR,e.beginPath(),e.moveTo(0,-0.5),e.lineTo(l*h-2*h,s-.5),e.lineTo(l*h+(p+q),s+r.right),e.lineTo(l*h+(p+q),s+m*k-r.right),e.lineTo(l*h-2*h,s+m*k+.5),e.lineTo(0,m+.5),e.closePath(),e.fill()}for(var t=0;t<n;t++){i=1+t/n*j*g;var u=(m-m*i)/2,v=t>=n-1?o:o+3;e.save(),e.translate(0,u),e.transform(h,0,0,i,0,0);while(t*o+v>TT.BOOK_WIDTH_CLOSED)v*=.9999;e.drawImage(TT.pageflip.texture,t*o,0,v,m,t*o,0,v,m),e.restore()}var w=Math.max(Math.abs(g),.9),x={top:{x:l*h+q,y:(m-m*i)/2},bottom:{x:l*h+q,y:(m-m*i)/2+m*i}};e.fillStyle=SERVER_VARIABLES.SOLID_BOOK_COLOR,e.beginPath(),e.moveTo(x.top.x,x.top.y+r.left),e.lineTo(x.top.x+p,x.top.y+r.right),e.lineTo(x.bottom.x+p,x.bottom.y-r.right),e.lineTo(x.bottom.x,x.bottom.y-r.left),e.closePath(),e.fill(),TT.pageflip.dirtyRegion.inflate(TT.PAGE_WIDTH+TT.pageflip.CANVAS_HORIZONTAL_PADDING+TT.PAGE_MARGIN_X-p,x.top.y+TT.pageflip.CANVAS_VERTICAL_PADDING),TT.pageflip.dirtyRegion.inflate(TT.PAGE_WIDTH+TT.pageflip.CANVAS_HORIZONTAL_PADDING+l*h+p,x.bottom.y+TT.pageflip.CANVAS_VERTICAL_PADDING),e.restore()},TT.pageflip.removeInactiveFlips=function(){var a=0;for(var b=0;b<TT.pageflip.flips.length;b++){var c=TT.pageflip.flips[b];c.progress!==c.target||c.target!==1&&c.target!==-1?a++:(TT.pageflip.flips.splice(b,1),b--)}a==0&&TT.pageflip.deactivate()},TT.pageflip.removeHardFlips=function(){for(var a=0;a<TT.pageflip.flips.length;a++){var b=TT.pageflip.flips[a];b.type==TT.pageflip.HARD_FLIP&&(TT.pageflip.flips.splice(a,1),a--)}},TT.pageflip.turnToPage=function(a,b,c,d){d==TT.pageflip.HARD_FLIP&&!TT.pageflip.dragging&&TT.pageflip.removeHardFlips();var e=TT.pageflip.getCurrentFlip();e.consumed&&(e=TT.pageflip.createFlip()),TT.pageflip.dragging=!1,TT.pageflip.turning=!0,TT.pageflip.hinting=!1,e.currentPage=a,e.targetPage=b,e.direction=c,e.alpha=1,e.consumed=!0,e.type=d||TT.pageflip.SOFT_FLIP,e.target=-1,c===-1&&(e.target=1,e.progress=-1),TT.navigation.isFullScreen()&&(e.progress=e.target*.95),TT.pageflip.activate(),TT.pageflip.redraw()},TT.pageflip.completeCurrentTurn=function(){if(TT.pageflip.turning){TT.pageflip.turning=!1;var a=TT.pageflip.flips[TT.pageflip.flips.length-1];a&&TT.navigation.updateCurrentPointer(a.currentPage,a.targetPage)}},TT.pageflip.getCurrentFlip=function(){return TT.pageflip.flips.length==0&&TT.pageflip.createFlip(),TT.pageflip.flips[TT.pageflip.flips.length-1]},TT.pageflip.createFlip=function(){TT.pageflip.flips.length>3&&(TT.pageflip.flips=TT.pageflip.flips.splice(4,99));var a=new TT.pageflip.Flip;return TT.pageflip.flips.push(a),a},TT.pageflip.getHintRegion=function(){var a=new Region;return TT.navigation.isHomePage()||TT.navigation.isLastPage()||TT.navigation.isCreditsPage()?(a.left=TT.BOOK_WIDTH_CLOSED-(TT.IS_TOUCH_DEVICE?TT.pageflip.HINT_WIDTH_TOUCH:TT.pageflip.HINT_WIDTH),a.right=TT.BOOK_WIDTH_CLOSED):(a.left=TT.PAGE_WIDTH-(TT.IS_TOUCH_DEVICE?TT.pageflip.HINT_WIDTH_TOUCH:TT.pageflip.HINT_WIDTH),a.right=TT.PAGE_WIDTH),a.top=0,a.bottom=TT.PAGE_HEIGHT,a},TT.pageflip.isMouseInHintRegion=function(){return TT.pageflip.getHintRegion().contains(TT.pageflip.mouse.x,TT.pageflip.mouse.y)},TT.pageflip.onKeyPress=function(a){if(!TT.search.hasFocus){var b=TT.time()-TT.pageflip.lastKeyboardNavigationTime>1e3;if(!(a.keyCode!=37||TT.pageflip.lastKeyboardNavigationDirection!==-1&&!b))return TT.navigation.goToPreviousPage(),TT.pageflip.lastKeyboardNavigationDirection=-1,TT.pageflip.lastKeyboardNavigationTime=TT.time(),a.preventDefault(),!1;if(!(a.keyCode!=39||TT.pageflip.lastKeyboardNavigationDirection!==1&&!b))return TT.navigation.goToNextPage(),TT.pageflip.lastKeyboardNavigationDirection=1,TT.pageflip.lastKeyboardNavigationTime=TT.time(),a.preventDefault(),!1;if(a.keyCode==27)return TT.fullscreen.exit(),a.preventDefault(),!1}},TT.pageflip.handlePointerDown=function(){TT.pageflip.isMouseInHintRegion()&&($("body").css("cursor","pointer"),TT.time()-TT.pageflip.mouseDownTime>TT.pageflip.CLICK_FREQUENCY&&(TT.pageflip.dragging=!0),TT.pageflip.mouseDownTime=TT.time(),TT.pageflip.activate())},TT.pageflip.handlePointerMove=function(){var a=TT.pageflip.hinting;TT.pageflip.hinting=!1,$("body").css("cursor","");if(!TT.pageflip.dragging&&!TT.pageflip.turning&&(!TT.navigation.isCreditsPage()||TT.navigation.isCreditsPage()&&TT.navigation.isBookOpen())){var b=TT.pageflip.getCurrentFlip();b.progress<0&&(b=TT.pageflip.createFlip());var c=TT.navigation.isHomePage()||TT.navigation.isLastPage()||TT.navigation.isCreditsPage()&&TT.navigation.isBookOpen();b.type=c?TT.pageflip.HARD_FLIP:TT.pageflip.SOFT_FLIP;if(TT.pageflip.isMouseInHintRegion()){if(TT.pageflip.mouseHistory[4])var d=TT.pageflip.mouse.x-(TT.pageflip.mouseHistory[4].x||0),e=TT.pageflip.mouse.y-(TT.pageflip.mouseHistory[4].y||0),f=Math.sqrt(d*d+e*e);else var f=0;if(!TT.navigation.isHomePage()||f<100)b.target=Math.min(TT.pageflip.mouse.x/TT.PAGE_WIDTH,.98),$("body").css("cursor","pointer"),TT.pageflip.activate(),TT.pageflip.hinting=!0,TT.navigation.isHomePage()?(b.target=Math.min(TT.pageflip.mouse.x/TT.PAGE_WIDTH,.95),$("#pages section.current").show().width(TT.PAGE_WIDTH)):$("#pages section.current").next("section").show().width(TT.PAGE_WIDTH)}else b.progress!==1&&b.target!==-1&&(TT.pageflip.hinting==1&&$("#pages section.current").next("section").width(0),b.target=1,TT.pageflip.activate(),TT.pageflip.hinting=!1)}else TT.pageflip.dragging&&TT.pageflip.getCurrentFlip().type!=TT.pageflip.HARD_FLIP&&(TT.pageflip.getCurrentFlip().alpha=1);while(TT.pageflip.mouseHistory.length>9)TT.pageflip.mouseHistory.pop();TT.pageflip.mouseHistory.unshift(TT.pageflip.mouse)},TT.pageflip.handlePointerUp=function(){if(TT.time()-TT.pageflip.mouseDownTime<TT.pageflip.CLICK_FREQUENCY)return TT.navigation.goToNextPage(),TT.pageflip.dragging=!1,!1;if(TT.pageflip.dragging&&TT.pageflip.mouse.x<TT.PAGE_WIDTH*.45){var a=TT.navigation.goToNextPage();a==0&&(TT.pageflip.dragging=!1)}else TT.pageflip.dragging=!1,TT.pageflip.handlePointerMove()},TT.pageflip.onMouseDown=function(a){TT.pageflip.mouse.down=!0,TT.pageflip.updateRelativeMousePosition(a.clientX,a.clientY),TT.pageflip.handlePointerDown();if(TT.pageflip.isMouseInHintRegion())return a.preventDefault(),!1},TT.pageflip.onMouseMove=function(a){TT.pageflip.updateRelativeMousePosition(a.clientX,a.clientY),TT.pageflip.handlePointerMove()},TT.pageflip.onMouseUp=function(a){TT.pageflip.mouse.down=!1,TT.pageflip.updateRelativeMousePosition(a.clientX,a.clientY),TT.pageflip.handlePointerUp()},TT.pageflip.onTouchStart=function(a){if(a.touches.length==1){var b=a.touches[0].pageX-(window.innerWidth-TT.PAGE_WIDTH)*.5,c=a.touches[0].pageY-(window.innerHeight-TT.PAGE_HEIGHT)*.5;TT.pageflip.updateRelativeMousePosition(b,c),TT.pageflip.mouse.down=!0,TT.pageflip.isMouseInHintRegion()&&(a.preventDefault(),TT.pageflip.handlePointerDown())}},TT.pageflip.onTouchMove=function(a){if(a.touches.length==1){var b=a.touches[0].pageX-(window.innerWidth-TT.PAGE_WIDTH)*.5,c=a.touches[0].pageY-(window.innerHeight-TT.PAGE_HEIGHT)*.5;TT.pageflip.updateRelativeMousePosition(b,c),TT.pageflip.isMouseInHintRegion()&&(a.preventDefault(),TT.pageflip.handlePointerMove())}},TT.pageflip.onTouchEnd=function(a){TT.pageflip.mouse.down=!1,TT.pageflip.handlePointerUp()},TT.pageflip.getRelativeMousePosition=function(a,b){var c={x:a,y:b};return c.x-=$("#pages").offset().left+TT.PAGE_WIDTH,c.y-=$("#pages").offset().top,c},TT.pageflip.updateRelativeMousePosition=function(a,b){var c=TT.pageflip.getRelativeMousePosition(a,b);TT.pageflip.mouse.x=c.x,TT.pageflip.mouse.y=c.y},TT.pageflip.Flip=function(){this.id=Math.round(Math.random()*1e3),this.currentPage=$("#pages section.current"),this.targetPage=$("#pages section.current"),this.direction=-1,this.progress=1,this.target=1,this.strength=0,this.alpha=1,this.type=TT.pageflip.SOFT_FLIP,this.x=0,this.consumed=!1},Region.prototype.reset=function(){this.left=999999,this.top=999999,this.right=0,this.bottom=0},Region.prototype.inflate=function(a,b){this.left=Math.min(this.left,a),this.top=Math.min(this.top,b),this.right=Math.max(this.right,a),this.bottom=Math.max(this.bottom,b)},Region.prototype.contains=function(a,b){return a>this.left&&a<this.right&&b>this.top&&b<this.bottom},Region.prototype.toRectangle=function(a){return a|=0,{x:this.left-a,y:this.top-a,width:this.right-this.left+a*2,height:this.bottom-this.top+a*2}},TT.paperstack={},TT.paperstack.container=null,TT.paperstack.initialize=function(){TT.paperstack.container=$("#paperstack")},TT.paperstack.updateStack=function(a){var b=$("div.paper",TT.paperstack.container).length,c=Math.round((1-(a?a:TT.chapternav.getProgress()))*b);c!=0?($(".paper:lt("+c+")",TT.paperstack.container).css({opacity:1}),$(".paper:gt("+c+")",TT.paperstack.container).css({opacity:0}),$(".shadow",TT.paperstack.container).css({opacity:1})):($(".paper",TT.paperstack.container).css({opacity:0}),$(".shadow",TT.paperstack.container).css({opacity:0})),$(".shadow",TT.paperstack.container).css({marginLeft:-9+c})},TT.illustrations={},TT.illustrations.FRAME_RATE=30,TT.illustrations.ASSETS_URL="../../img/wordbook/",TT.illustrations.interval=-1,TT.illustrations.update=function(a){TT.illustrations.deactivate(),a&&!TT.navigation.isHomePage()&&!TT.navigation.isFullScreen()&&(TT.log("Activate animation: "+a.attr("class")),a.hasClass("title-html")&&a.hasClass("page-3")?TT.illustrations.html.activate($("div.image1",a)):a.hasClass("title-foreword")&&a.hasClass("page-1")?TT.illustrations.cloud.activate($("div.image1",a)):a.hasClass("title-open-source")&&a.hasClass("page-1")?TT.illustrations.opensource.activate($("div.image1",a)):a.hasClass("title-what-is-the-internet")&&a.hasClass("page-1")?TT.illustrations.internet.activate($("div.image1",a)):a.hasClass("title-page-load")&&a.hasClass("page-1")?TT.illustrations.pageload.activate($("div.image1",a)):a.hasClass("title-web-apps")&&a.hasClass("page-1")?TT.illustrations.webapps.activate($("div.image1",a)):a.hasClass("title-threed")&&a.hasClass("page-1")&&TT.illustrations.threed.activate($("div.image1",a)))},TT.illustrations.deactivate=function(){clearInterval(TT.illustrations.interval)},TT.illustrations.createCanvas=function(a,b){var c=$("<canvas></canvas>");return c[0].width=b.width,c[0].height=b.height,a.append(c),TT.illustrations.updateCanvasPosition(a,b),c},TT.illustrations.updateCanvasPosition=function(a,b){var c=$("canvas",a);return c.css({position:"absolute",left:$("img",a).position().left+b.x,top:$("img",a).position().top+b.y}),$("img",a).width()!==0||$("img",a).height()!==0},TT.illustrations.threed={canvas:null,context:null,container:null,image:null,cloudImage:null,clouds:[],alpha:0,world:{x:0,y:0,width:320,height:150},positioned:!1,initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d"),this.cloudImage=new Image,this.cloudImage.src=TT.illustrations.ASSETS_URL+"3d01_clouds.png",this.clouds.push({source:{x:0,y:0,width:63,height:35},x:44,y:16,originalX:44,originalY:16,velocity:{x:0,y:0}}),this.clouds.push({source:{x:0,y:36,width:70,height:40},x:147,y:10,originalX:147,originalY:10,velocity:{x:0,y:0}}),this.clouds.push({source:{x:0,y:78,width:84,height:50},x:213,y:48,originalX:212,originalY:48,velocity:{x:0,y:0}})):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.threed.draw()},draw:function(){this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.context.clearRect(0,0,this.world.width,this.world.height);if(this.cloudImage.complete){this.alpha=Math.min(this.alpha+.1,1),this.context.globalAlpha=this.alpha;for(var a=0;a<this.clouds.length;a++){var b=this.clouds[a];b.x+=b.velocity.x,b.y+=b.velocity.y,b.velocity.x*=.96,b.velocity.y*=.96;var c=.3;Math.abs(b.velocity.x)<.01&&(b.x>b.originalX?b.velocity.x-=.05+Math.random()*c:b.velocity.x+=.05+Math.random()*c),Math.abs(b.velocity.y)<.01&&(b.y>b.originalY?b.velocity.y-=.01+Math.random()*c:b.velocity.y+=.01+Math.random()*c),this.context.save(),this.context.translate(b.x,b.y),this.context.drawImage(this.cloudImage,b.source.x,b.source.y,b.source.width,b.source.height,0,0,b.source.width,b.source.height),this.context.restore()}}}},TT.illustrations.webapps={GRAVITY:.04,canvas:null,context:null,container:null,image:null,leaves:[],points:[{x:86,y:100},{x:35,y:88},{x:168,y:35},{x:250,y:15}],world:{x:20,y:30,width:300,height:260},positioned:!1,initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d")):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.webapps.draw()},draw:function(){this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.context.clearRect(0,0,this.world.width,this.world.height);if(this.leaves.length<4&&Math.random()>.9){var a=this.points[Math.floor(Math.random()*this.points.length)];this.leaves.push({x:a.x,y:a.y,w:18+Math.random()*8,h:6+Math.random()*4,alpha:0,rotation:Math.random()*Math.PI,velocity:{x:-0.2+Math.random()*.4,y:Math.random()*2,rotation:-0.1+Math.random()*.2}})}for(var b=0;b<this.leaves.length;b++){var c=this.leaves[b];c.velocity.y+=this.GRAVITY;if(c.y>this.world.height+20){this.leaves.splice(b,1),b--;continue}c.x+=c.velocity.x,c.y+=c.velocity.y,c.rotation+=c.velocity.rotation,c.alpha=Math.min(c.alpha+.1,1),this.context.save();var d=3;this.context.globalAlpha=c.alpha,this.context.beginPath(),this.context.translate(c.x,c.y),this.context.rotate(c.rotation),this.context.strokeStyle="rgba(0,100,20,0.7)",this.context.fillStyle="rgba(159,192,94,0.9)",this.context.moveTo(0,c.h/2),this.context.quadraticCurveTo(c.w/2,-d,c.w,c.h/2),this.context.quadraticCurveTo(c.w/2,c.h+d,0,c.h/2),this.context.stroke(),this.context.fill(),this.context.restore()}var e=this.context.createLinearGradient(0,0,0,this.world.height);e.addColorStop(.7,"rgba(255, 255, 255, 0)"),e.addColorStop(1,"rgba(255, 255, 255, 1)"),this.context.save(),this.context.globalCompositeOperation="destination-out",this.context.beginPath(),this.context.fillStyle=e,this.context.fillRect(0,0,this.world.width,this.world.height),this.context.restore()}},TT.illustrations.pageload={GRAVITY:.04,canvas:null,context:null,container:null,image:null,bubbles:[],world:{x:10,y:100,width:220,height:100},positioned:!1,initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d")):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.pageload.draw()},draw:function(){this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.context.clearRect(0,0,this.world.width,this.world.height),this.bubbles.length<7&&Math.random()>.85&&this.bubbles.push({x:Math.random()*this.world.width,y:this.world.height+10,alpha:0,size:1+Math.random()*3,velocity:{x:-0.4+Math.random()*.8,y:Math.random()*-2}});for(var a=0;a<this.bubbles.length;a++){var b=this.bubbles[a];b.velocity.y-=this.GRAVITY;if(b.y<-10){this.bubbles.splice(a,1),a--;continue}b.y<this.world.height*.3?b.alpha=Math.max(b.y/(this.world.height*.3),0):b.y>this.world.height*.7&&(b.alpha=1-Math.min((b.y-this.world.height*.7)/(this.world.height*.3),1)),b.x+=b.velocity.x,b.y+=b.velocity.y,this.context.beginPath(),this.context.strokeStyle="rgba( 0, 0, 0, "+b.alpha*.3+" )",this.context.fillStyle="rgba( 0, 180, 250, "+b.alpha*.7+" )",this.context.arc(b.x,b.y,b.size,0,Math.PI*2,!0),this.context.stroke()}var c=this.context.createLinearGradient(0,0,-25,this.world.height);c.addColorStop(0,"rgba(255, 255, 255, 1)"),c.addColorStop(.6,"rgba(255, 255, 255, 0)"),this.context.save(),this.context.globalCompositeOperation="destination-out",this.context.beginPath(),this.context.fillStyle=c,this.context.fillRect(0,0,this.world.width,this.world.height),this.context.restore()}},TT.illustrations.internet={GRAVITY:.04,canvas:null,context:null,container:null,image:null,zero:null,one:null,numbers:[],positioned:!1,world:{x:345,y:115,width:120,height:80},initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d"),this.zero=new Image,this.zero.src=TT.illustrations.ASSETS_URL+"internet01-part1.png",this.one=new Image,this.one.src=TT.illustrations.ASSETS_URL+"internet01-part2.png"):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.internet.draw()},draw:function(){this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.context.clearRect(0,0,this.world.width,this.world.height);if(this.zero.complete&&this.one.complete){this.numbers.length<20&&Math.random()>.6&&this.numbers.push({type:Math.random()>.5?1:0,x:5,y:0,alpha:0,rotation:Math.random()*Math.PI,velocity:{x:.4+Math.random()*1.6,y:Math.random()*2,rotation:-0.1+Math.random()*.2}});for(var a=0;a<this.numbers.length;a++){var b=this.numbers[a],c=b.type==0?this.zero:this.one;b.velocity.y+=this.GRAVITY;if(b.y>this.world.height+c.height){this.numbers.splice(a,1),a--;continue}b.y<this.world.height*.1&&(b.alpha=Math.min(b.y/(this.world.height*.1),1)),b.y>this.world.height*.6&&(b.alpha=1-Math.min((b.y-this.world.height*.5)/(this.world.height*.3),1)),b.x+=b.velocity.x,b.y+=b.velocity.y,b.rotation+=b.velocity.rotation,this.context.save(),this.context.globalAlpha=b.alpha,this.context.translate(b.x+Math.round(c.width*.5),b.y+Math.round(c.height*.5)),this.context.rotate(b.rotation),this.context.translate(-Math.round(c.width*.5),-Math.round(c.height*.5)),this.context.drawImage(c,0,0),this.context.restore()}}}},TT.illustrations.opensource={canvas:null,context:null,container:null,image:null,cog1:{image:null,x:57,y:14,currentRotation:0,targetRotation:0,lastUpdate:0},cog2:{image:null,x:28,y:38,currentRotation:0,targetRotation:0,lastUpdate:0},alpha:0,world:{x:90,y:37,width:100,height:100},positioned:!1,initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d"),this.cog1.image=new Image,this.cog1.image.src=TT.illustrations.ASSETS_URL+"opensource01-part1.png",this.cog2.image=new Image,this.cog2.image.src=TT.illustrations.ASSETS_URL+"opensource01-part2.png"):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),this.cog1.lastUpdate=TT.time(),this.cog2.lastUpdate=TT.time(),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.opensource.draw()},draw:function(){this.context.clearRect(0,0,this.world.width,this.world.height),this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.cog1.image.complete&&this.cog2.image.complete&&(this.alpha=Math.min(this.alpha+.08,1),this.cog1.currentRotation>this.cog1.targetRotation-1&&TT.time()-this.cog1.lastUpdate>2e3&&(this.cog1.targetRotation+=Math.PI/3,this.cog1.lastUpdate=TT.time()),this.cog2.currentRotation>this.cog2.targetRotation-1&&TT.time()-this.cog2.lastUpdate>6e3&&(this.cog2.targetRotation+=Math.PI/9,this.cog2.lastUpdate=TT.time()),this.cog1.currentRotation+=(this.cog1.targetRotation-this.cog1.currentRotation)*.5,this.cog2.currentRotation+=(this.cog2.targetRotation-this.cog2.currentRotation)*.4,Math.abs(this.cog1.currentRotation-this.cog1.targetRotation)<.05&&(this.cog1.currentRotation=this.cog1.targetRotation),Math.abs(this.cog2.currentRotation-this.cog2.targetRotation)<.05&&(this.cog2.currentRotation=this.cog2.targetRotation),this.context.save(),this.context.globalAlpha=this.alpha,this.context.save(),this.context.translate(this.cog1.x+Math.round(this.cog1.image.width*.5),this.cog1.y+Math.round(this.cog1.image.height*.5)),this.context.rotate(this.cog1.currentRotation),this.context.translate(-Math.round(this.cog1.image.width*.5),-Math.round(this.cog1.image.height*.5)),this.context.drawImage(this.cog1.image,0,0),this.context.restore(),this.context.save(),this.context.translate(this.cog2.x+Math.round(this.cog2.image.width*.5),this.cog2.y+Math.round(this.cog2.image.height*.5)),this.context.rotate(this.cog2.currentRotation),this.context.translate(-Math.round(this.cog2.image.width*.5),-Math.round(this.cog2.image.height*.5)),this.context.drawImage(this.cog2.image,0,0),this.context.restore(),this.context.restore())}},TT.illustrations.cloud={canvas:null,context:null,container:null,image:null,cloutImage:null,world:{x:0,y:0,width:240,height:200},positioned:!1,clouds:[{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8},{x:Math.random()*240,y:Math.random()*200,strength:1,velocity:{x:0,y:0},size:8+Math.random()*8}],initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d"),this.cloudImage=new Image,this.cloudImage.src=TT.illustrations.ASSETS_URL+"3d01_clouds.png"):this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.cloud.draw()},draw:function(){this.positioned||(this.positioned=TT.illustrations.updateCanvasPosition(this.container,this.world)),this.context.clearRect(0,0,this.world.width,this.world.height),this.image[0].complete&&this.context.drawImage(this.image[0],0,0);var a=3;for(var b=0,c=this.clouds.length;b<c;b++){var d=this.clouds[b];d.velocity.x/=1.04,d.velocity.y/=1.04,Math.abs(d.velocity.x)<.2&&(d.x>this.world.width/2?d.velocity.x-=.7+Math.random()*a:d.velocity.x+=.7+Math.random()*a),Math.abs(d.velocity.y)<.2&&(d.y>this.world.height/2?d.velocity.y-=.5+Math.random()*a:d.velocity.y+=.5+Math.random()*a),d.x+=d.velocity.x,d.y+=d.velocity.y,d.strength=Math.max(Math.min(d.strength,1),0);var e=this.context.createRadialGradient(d.x,d.y,0,d.x,d.y,d.size);this.context.save();var f=BrowserDetect.browser.toLowerCase();f=="firefox"?(e.addColorStop(.4,"rgba(255,255,255,"+d.strength*.7+")"),e.addColorStop(1,"rgba(255,255,255,0)")):(e.addColorStop(.4,"rgba(90,170,190,"+d.strength+")"),e.addColorStop(1,"rgba(90,170,190,0)"),this.context.globalCompositeOperation="source-in"),this.context.beginPath(),this.context.fillStyle=e,this.context.arc(d.x,d.y,d.size,0,Math.PI*2,!0),this.context.fill(),this.context.restore()}}},TT.illustrations.html={canvas:null,context:null,container:null,image:null,world:{x:100,y:-15,width:150,height:200},bulbs:[{x:27,y:22,strength:0,momentum:0,size:10},{x:62,y:30,strength:0,momentum:0,size:10},{x:90,y:39,strength:0,momentum:0,size:10},{x:117,y:48,strength:0,momentum:0,size:10},{x:22,y:59,strength:0,momentum:0,size:10},{x:23,y:89,strength:0,momentum:0,size:10},{x:24,y:115,strength:0,momentum:0,size:10},{x:25,y:139,strength:0,momentum:0,size:10},{x:124,y:87,strength:0,momentum:0,size:10},{x:124,y:116,strength:0,momentum:0,size:10},{x:124,y:144,strength:0,momentum:0,size:10},{x:124,y:178,strength:0,momentum:0,size:10}],initialize:function(a){this.canvas===null?(this.container=a,this.image=$("img",a),this.canvas=TT.illustrations.createCanvas(a,this.world),this.context=this.canvas[0].getContext("2d")):TT.illustrations.updateCanvasPosition(this.container,this.world)},activate:function(a){this.initialize(a),TT.illustrations.interval=setInterval(this.render,1e3/TT.illustrations.FRAME_RATE)},render:function(){TT.illustrations.html.draw()},draw:function(){this.context.clearRect(0,0,this.world.width,this.world.height);for(var a=0,b=this.bulbs.length;a<b;a++){var c=this.bulbs[a];c.strength<.1&&c.momentum<=0&&Math.random()>.98?c.momentum=Math.random()*.3:c.strength>=1&&Math.random()>.98&&(c.momentum=-Math.random()*.3),c.strength+=c.momentum,c.strength=Math.max(Math.min(c.strength,1),0);var d=this.context.createRadialGradient(c.x,c.y,0,c.x,c.y,c.size);d.addColorStop(.4,"rgba(255,255,100,"+c.strength*.95+")"),d.addColorStop(1,"rgba(255,255,100,0)"),this.context.beginPath(),this.context.fillStyle=d,this.context.arc(c.x,c.y,c.size,0,Math.PI*2,!0),this.context.fill()}}},TT.navigation={},TT.navigation.transitioningFromHardCover=!1,TT.navigation.hasNavigated=!1,TT.navigation.currentPageName="",TT.navigation.enqueueNavigation=null,TT.navigation.initialize=function(){$("#pages section:not(.current)").width(0).hide(),TT.navigation.assignNavigationHandlers(),TT.navigation.assignNextPrevHandlers(),TT.navigation.isHomePage()?TT.flipintro.activate():($("#front-cover").hide(),$("#front-cover-bookmark").hide(),$("#front-cover-arrow").hide()),TT.navigation.isCreditsPage()||$("#back-cover").hide(),TT.navigation.isTableOfThings()?$("body").addClass("home").addClass("tot"):!TT.navigation.isHomePage()&&!TT.navigation.isCreditsPage()&&$("body").addClass("book"),TT.sharing.updateSharer(),TT.navigation.loadImages(),TT.illustrations.update($("#pages section.current")),TT.navigation.updatePageVisibility($("#pages section.current"))},TT.navigation.assignNavigationHandlers=function(){$("header a.logo").click(function(){return TT.navigation.goToHome(),!1}),$("header li.about a").click(function(){return TT.navigation.goToPage(TT.history.FOREWORD,1),!1}),$("header li.credits a").click(function(){return TT.navigation.goToCredits(),!1}),$("#front-cover-bookmark a.open-book").click(function(){return TT.navigation.goToNextPage(),!1}),$("header li.table-of-things a").click(function(){return TT.tableofthings.show(),!1}),$("#table-of-contents a.go-back").click(function(){return TT.tableofthings.hide(),!1}),$("#front-cover-arrow").click(function(){return TT.navigation.goToNextPage(),!1}),$("footer .print a").click(function(){if(window.location.pathname.match("en-US"))return TT.overlay.showPrint(),!1}),$("#pages section a").click(function(){var a=$(this).attr("href");if(a.indexOf("http://")==-1&&a.indexOf("www.")==-1){var b=a.split("/")[1],c=a.split("/")[2];return b&&c&&TT.navigation.goToPage(b,c),!1}})},TT.navigation.assignNextPrevHandlers=function(){$("#pagination-prev").click(function(a){a.preventDefault(),TT.navigation.goToPreviousPage()}),$("#pagination-next").click(function(a){a.preventDefault(),TT.navigation.goToNextPage()});var a='<div class="page-progress"><p class="thing"></p><p class="number">'+SERVER_VARIABLES.PAGE+" <span></span></p></div>";TT.IS_TOUCH_DEVICE||($("#pagination-prev").append(a),$("#pagination-next").append(a))},TT.navigation.isHomePage=function(){return $("body").hasClass("home")},TT.navigation.isCreditsPage=function(){return $("body").hasClass("credits")},TT.navigation.isTableOfThings=function(){return $("body").hasClass("tot")},TT.navigation.isBookOpen=function(){return $("body").hasClass("book")},TT.navigation.isFullScreen=function(){return $("body").hasClass("fullscreen")},TT.navigation.isForeword=function(a){return a||(a=$("#pages section.current")),TT.navigation.classToArticle(a.attr("class"))==TT.history.FOREWORD},TT.navigation.isLastPage=function(a){return a?a.next("section").length==0&&!TT.navigation.isCreditsPage():$("#pages section.current").next("section")
.length==0&&!TT.navigation.isCreditsPage()},TT.navigation.isFirstPage=function(a){return a?a.prev("section").length==0&&!TT.navigation.isHomePage():$("#pages section.current").prev("section").length==0&&!TT.navigation.isHomePage()},TT.navigation.classToArticle=function(a){return a?a.match(/title-([a-zA-Z-0-9]+)/)[1]:null},TT.navigation.classToArticlePage=function(a){return a?parseInt(a.match(/page-([0-9]+)/)[1]):null},TT.navigation.classToGlobalPage=function(a){return a?parseInt(a.match(/globalPage-([0-9]+)/)[1]):null},TT.navigation.updateNextPrevLinks=function(a){TT.navigation.isCreditsPage()?($("#pagination-next").addClass("inactive"),$("#pagination-prev").removeClass("inactive")):TT.navigation.isHomePage()?($("#pagination-prev").addClass("inactive"),$("#pagination-next").removeClass("inactive")):$("#pagination-prev, #pagination-next").removeClass("inactive");var b=TT.navigation.isHomePage()?a.attr("class"):a.next("section").attr("class"),c=a.prev("section").attr("class");b?TT.navigation.updatePaginationHint(b,$("#pagination-next")):$("#pagination-next .page-progress").hide(),c&&!TT.navigation.isLastPage()&&!TT.navigation.isCreditsPage()?TT.navigation.updatePaginationHint(c,$("#pagination-prev")):$("#pagination-prev .page-progress").hide()},TT.navigation.updatePaginationHint=function(a,b){var c=TT.navigation.classToArticle(a),d=$("#chapter-nav ul li").find("[data-article="+c+"]").parent().index()+1,e=TT.navigation.classToArticlePage(a),f=$("#pages section.title-"+c).length;e!=undefined&&f!=undefined?($(".page-progress",b).show(),c==TT.history.FOREWORD?$("p.thing",b).html(SERVER_VARIABLES.FOREWORD):$("p.thing",b).html(SERVER_VARIABLES.THING+" "+d),$("p.number span",b).text(e+"/"+f)):$(".page-progress",b).hide()},TT.navigation.getCurrentArticleId=function(){return TT.navigation.classToArticle($("#pages section.current").attr("class"))},TT.navigation.getCurrentArticlePage=function(){return TT.navigation.classToArticlePage($("#pages section.current").attr("class"))},TT.navigation.goToPreviousPage=function(){TT.navigation.cleanUpTransitions();if(TT.navigation.transitioningFromHardCover)return!1;if(TT.navigation.isFirstPage())return TT.navigation.isHomePage()||(TT.pageflip.completeCurrentTurn(),TT.navigation.goToHome()),!1;TT.pageflip.completeCurrentTurn();var a=$("#pages section.current"),b,c=null;TT.navigation.isCreditsPage()?(b=TT.navigation.classToArticle(a.attr("class")),c=TT.navigation.classToArticlePage(a.attr("class"))):(b=TT.navigation.classToArticle(a.prev("section").attr("class")),c=TT.navigation.classToArticlePage(a.prev("section").attr("class"))),TT.navigation.goToPage(b,c)},TT.navigation.goToNextPage=function(){TT.navigation.cleanUpTransitions();if(TT.navigation.transitioningFromHardCover)return!1;if(TT.navigation.isLastPage()||TT.navigation.isCreditsPage()){if(!TT.navigation.isCreditsPage()||TT.navigation.isCreditsPage()&&TT.navigation.isBookOpen())TT.pageflip.completeCurrentTurn(),TT.navigation.goToCredits();return!1}TT.pageflip.completeCurrentTurn();var a=$("#pages section.current"),b,c=null;TT.navigation.isHomePage()?(nextArticle=TT.navigation.classToArticle(a.attr("class")),nextPage=TT.navigation.classToArticlePage(a.attr("class"))):(TT.pageflip.completeCurrentTurn(),nextArticle=TT.navigation.classToArticle(a.next("section").attr("class")),nextPage=TT.navigation.classToArticlePage(a.next("section").attr("class"))),TT.navigation.goToPage(nextArticle,nextPage)},TT.navigation.goToHome=function(a){TT.tableofthings.hide();if(!TT.navigation.isHomePage()){if(TT.navigation.isCreditsPage()){TT.navigation.enqueueNavigation={call:function(){delete this.call,setTimeout(TT.navigation.goToHome,1)}},TT.navigation.goToPage(TT.history.THEEND,1,!1);return}TT.navigation.currentPageName=TT.history.HOME,$("#back-cover").hide(),$("body").removeClass("book").removeClass(TT.history.CREDITS).addClass(TT.history.HOME),TT.flipintro.activate(),TT.sharing.updateSharer(),TT.navigation.transitioningFromHardCover=!1,$("#pages section").removeClass("current"),$("#pages section").first().addClass("current");var b=$("#pages section.current");b.width(TT.PAGE_WIDTH),a||TT.history.pushState("/"+TT.locale.getLocaleCodeFromURL()+"/home"),TT.pageflip.turnToPage(b,b,-1,TT.pageflip.HARD_FLIP)}},TT.navigation.goToCredits=function(a){TT.tableofthings.hide();if(!TT.navigation.isCreditsPage()||TT.navigation.isCreditsPage()&&TT.navigation.isBookOpen()){if((TT.navigation.isBookOpen()||TT.navigation.isHomePage())&&!TT.navigation.isLastPage()&&!TT.navigation.isCreditsPage()){TT.navigation.enqueueNavigation={call:function(){delete this.call,setTimeout(TT.navigation.goToCredits,1)}},TT.navigation.goToPage(TT.history.THEEND,1,!1),TT.paperstack.updateStack(1);return}TT.navigation.currentPageName=TT.history.CREDITS,$("#page-shadow-overlay").hide(),$("#front-cover").hide(),$("#front-cover-bookmark").hide(),$("#front-cover-arrow").hide(),$("body").removeClass("book").removeClass(TT.history.HOME).addClass(TT.history.CREDITS),TT.sharing.updateSharer(),TT.navigation.transitioningFromHardCover=!1,$("#pages section").removeClass("current"),$("#pages section").last().addClass("current");var b=$("#pages section.current");TT.navigation.updatePageVisibility(b,1),a||TT.history.pushState("/"+TT.locale.getLocaleCodeFromURL()+"/credits"),TT.pageflip.turnToPage(b,b,1,TT.pageflip.HARD_FLIP)}},TT.navigation.goToPage=function(a,b,c){TT.navigation.loadImages(a,b),TT.navigation.isCreditsPage()&&a!==TT.history.THEEND&&(TT.navigation.enqueueNavigation={articleId:a,pageNumber:b,fromHistoryChange:c,call:function(){delete this.call,TT.navigation.goToPage(this.articleId,this.pageNumber,this.fromHistoryChange)}},a=TT.history.THEEND,b=1);var d=$("#pages section.current"),e=$("#pages section.title-"+a+".page-"+b);TT.navigation.hasNavigated=!0,TT.tableofthings.hide();var f=d.attr("class")===e.attr("class"),g=e.attr("class")===TT.navigation.currentPageName;if(!g&&!f||TT.navigation.isHomePage()||TT.navigation.isCreditsPage()){TT.navigation.currentPageName=e.attr("class"),TT.navigation.classToArticle(TT.navigation.currentPageName)==TT.history.THEEND&&TT.sharing.updateSharer(!0);var h=TT.pageflip.SOFT_FLIP;if(TT.navigation.isHomePage()||TT.navigation.isCreditsPage())h=TT.pageflip.HARD_FLIP,TT.navigation.transitioningFromHardCover=!0;var i=TT.navigation.classToGlobalPage($(".current").attr("class")),j=TT.navigation.classToGlobalPage(e.attr("class"));if(i!=null&&j!=null){var k=Math.abs(i-j),l=j>i?1:-1;return j==i&&(l=TT.navigation.isHomePage()?1:-1),TT.navigation.updatePageVisibility(e,l,k),TT.pageflip.turnToPage(d,e,l,h),c||TT.history.pushState("/"+TT.locale.getLocaleCodeFromURL()+"/"+a+"/"+b),TT.storage.setBookmark(a,b),TT.navigation.updateNextPrevLinks(e),TT.navigation.updatePageReferences(a),!0}}return!1},TT.navigation.updatePageVisibility=function(a,b,c){c=c||0;var d=parseInt($("#pages section.current").css("z-index"));if(c>1||TT.navigation.isHomePage())d=parseInt(a.css("z-index"));$("#pages section:not(.current)").each(function(){var a=parseInt($(this).css("z-index"));a>d?$(this).width(0).hide().css("top"):a<d-1&&$(this).hide()}),a.show(),c>1&&b==1&&TT.navigation.isHomePage()&&($("#pages section.current").width(0).hide(),a.width(TT.PAGE_WIDTH).show()),TT.navigation.isHomePage()||$("#left-page").width(TT.BOOK_WIDTH_CLOSED).show()},TT.navigation.updateCurrentPointer=function(a,b){TT.navigation.transitioningFromHardCover&&($("body").removeClass(TT.history.HOME).removeClass(TT.history.CREDITS).addClass("book"),$("#page-shadow-overlay").hide(),TT.navigation.transitioningFromHardCover=!1),a.removeClass("current"),b.addClass("current"),TT.sharing.updateSharer(),TT.navigation.updatePageReferences(),TT.navigation.updateNextPrevLinks(b),TT.navigation.enqueueNavigation&&TT.navigation.enqueueNavigation.call&&(TT.navigation.enqueueNavigation.call(),TT.navigation.enqueueNavigation=null)},TT.navigation.updatePageReferences=function(a){TT.chapternav.updateSelection(a),TT.tableofthings.updateSelection(a),TT.paperstack.updateStack(),TT.illustrations.update($("#pages section.current"))},TT.navigation.cleanUpTransitions=function(a,b){TT.pageflip.removeInactiveFlips(),TT.pageflip.flips.length==0&&(TT.navigation.transitioningFromHardCover=!1)},TT.navigation.loadImages=function(a,b){var c=a&&b?$("#pages section.title-"+a+".page-"+b):$("#pages section.current"),d=[c];c.prev("section").length&&d.push(c.prev("section")),c.next("section").length&&d.push(c.next("section"));for(var e=0;e<d.length;e++)d[e].find("img").each(function(){$(this).attr("src")!==$(this).attr("data-src")&&$(this).attr("src",$(this).attr("data-src"))})},TT.cache={},TT.cache.initialize=function(){$(window.applicationCache).bind("downloading",TT.cache.onDownloadingHandler),$(window.applicationCache).bind("progress",TT.cache.onProgressHandler),$(window.applicationCache).bind("error",TT.cache.onErrorHandler),$(window.applicationCache).bind("cached",TT.cache.onCachedHandler),$(window.applicationCache).bind("updateready",TT.cache.onUpdateReadyHandler),$(window.applicationCache).bind("noupdate",TT.cache.onNoUpdateHandler),$(window.applicationCache).bind("obsolete",TT.cache.onObsoleteHandler)},TT.cache.onDownloadingHandler=function(a){TT.log("TT.cache.onDownloadingHandler")},TT.cache.onNoUpdateHandler=function(a){TT.log("TT.cache.onNoUpdateHandler")},TT.cache.onProgressHandler=function(a){TT.log("TT.cache.onProgressHandler")},TT.cache.onErrorHandler=function(a){TT.log("TT.cache.onErrorHandler")},TT.cache.onObsoleteHandler=function(a){TT.log("TT.cache.onObsoleteHandler")},TT.cache.onCachedHandler=function(a){TT.log("TT.cache.onCachedHandler")},TT.cache.onUpdateReadyHandler=function(a){TT.log("TT.cache.onCachedHandler")},TT.search={},TT.search.THING_RESULTS_LIMIT=2,TT.search.KEYWORD_RESULTS_LIMIT=8,TT.search.DEFAULT_TEXT=$("#search-field").attr("value"),TT.search.dropdown=null,TT.search.dropdownResults=null,TT.search.dropdownTitles=null,TT.search.dropdownKeywords=null,TT.search.field=null,TT.search.hasFocus=!1,TT.search.titleResults=[],TT.search.keywordResults=[],TT.search.hideInterval=-1,TT.search.initialize=function(){TT.search.field=$("#search-field"),TT.search.dropdown=$("#search-dropdown"),TT.search.dropdownResults=$("#search-dropdown div.results"),TT.search.dropdownTitles=$("#search-dropdown div.results .things"),TT.search.dropdownKeywords=$("#search-dropdown div.results .keywords"),TT.search.field.focus(TT.search.onSearchFieldFocus),TT.search.field.blur(TT.search.onSearchFieldBlur),TT.search.field.change(TT.search.onSearchFieldChange),TT.search.field.keyup(TT.search.onSearchFieldChange),TT.search.field.click(function(a){TT.search.field.val()==""&&TT.search.onSearchFieldChange(a)})},TT.search.onSearchFieldFocus=function(a){clearInterval(TT.search.hideInterval),a.target.value===TT.search.DEFAULT_TEXT&&(a.target.value=""),TT.search.showResult(),TT.search.hasFocus=!0,$("header, #search-dropdown").addClass("searching")},TT.search.onSearchFieldBlur=function(a){clearInterval(TT.search.hideInterval),a.target.value===""&&(a.target.value=TT.search.DEFAULT_TEXT),TT.search.hideInterval=setInterval(TT.search.hideResults,100),TT.search.hasFocus=!1,$("header, #search-dropdown").removeClass("searching")},TT.search.onSearchFieldChange=function(a){clearInterval(TT.search.hideInterval),TT.search.field.val()==""||TT.search.field.val().length<2?(TT.search.titleResults=[],TT.search.keywordResults=[],TT.search.hideResults()):TT.search.searchFor(TT.search.field.val())},TT.search.searchFor=function(a){TT.search.titleResults=[],TT.search.keywordResults=[],TT.search.regexEscape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};var b=new RegExp(TT.search.regexEscape(a),"gi");$(".page h2, .page h3, .page p").each(function(){var c=$(this),d=$(this).text();if(b.test(d)){var e=d.match(b),f={};for(var g=0;g<e.length;g++)f[e[g]]=!0;for(a in f){var h=d.split(a);for(g=1;g<h.length;g++){var i={},j=h[g-1].substr(-10).replace(/</,"&lt;"),k=h[g].substr(0,10).replace(/</,"&lt;");i.articleId=c.parents("section").eq(0).attr("class").match(/title-([a-z-0-9]+)/)[1],a=a.replace(/</,"&lt;"),i.snippet=j+"<strong>"+a+"</strong>"+k;var l=$("#chapter-nav ul li").find("[data-article="+i.articleId+"]");if(l.length>0){i.articlePage=c.parents("section").eq(0).attr("class").match(/page-([0-9]+)/)[1],i.articleIndex=l.parent().index()+1,i.articleTitle=l.attr("data-title"),i.articleGlobalStartPage=$(".pageNumber",c.parents("section")).text(),i.articleGlobalEndPage=l.attr("data-globalendpage"),i.articleTitle.length>38&&(i.articleTitle=i.articleTitle.slice(0,36)+"...");if(c.is("h2")||c.is("h3")){var m=!1;for(var n=0;n<TT.search.titleResults.length;n++)TT.search.titleResults[n].articleTitle==i.articleTitle&&(m=!0);m||TT.search.titleResults.push(i)}else TT.search.keywordResults.push(i)}}}}}),TT.search.showResult()},TT.search.showResult=function(){TT.search.dropdownTitles.children("ul").remove(),TT.search.dropdownKeywords.children("ul").remove();var a=TT.search.titleResults.length>0,b=TT.search.keywordResults.length>0;a||TT.search.dropdownTitles.hide(),b||TT.search.dropdownKeywords.hide(),b||a?TT.search.dropdown.removeClass("no-results").addClass("open"):TT.search.field.val()!=""&&TT.search.dropdown.addClass("no-results").addClass("open");if(a){var c=$("<ul/>");for(var d=0;d<Math.min(TT.search.titleResults.length,TT.search.THING_RESULTS_LIMIT);d++){var e=TT.search.titleResults[d],f=$("<li/>").mousedown(function(){TT.navigation.goToPage($(this).attr("class"),1)});f.addClass(e.articleId),f.append('<div class="illustration"></div>'),f.append('<p class="title">#'+e.articleIndex+" "+e.articleTitle+"</p>"),Math.abs(parseInt(e.articleGlobalStartPage)-parseInt(e.articleGlobalEndPage))!=0?f.append('<p class="pages">'+SERVER_VARIABLES.PAGES+": "+e.articleGlobalStartPage+"-"+e.articleGlobalEndPage+"</p>"):f.append('<p class="pages">'+SERVER_VARIABLES.PAGE+": "+e.articleGlobalStartPage+"</p>"),c.append(f)}TT.search.dropdownTitles.append(c),TT.search.dropdownTitles.show()}if(b){var c=$("<ul/>");for(var d=0;d<Math.min(TT.search.keywordResults.length,TT.search.KEYWORD_RESULTS_LIMIT);d++){var e=TT.search.keywordResults[d],f=$("<li/>").mousedown(function(){TT.navigation.goToPage($(this).attr("data-articleId"),$(this).attr("data-articlePage"))});f.attr("data-articleId",e.articleId),f.attr("data-articlePage",e.articlePage),f.append('<p class="snippet">"...'+e.snippet+'..."</p>'),f.append('<p class="pages">'+SERVER_VARIABLES.THING+" #"+e.articleIndex+" "+SERVER_VARIABLES.PAGE+": "+e.articleGlobalStartPage+"</p>"),c.append(f)}TT.search.dropdownKeywords.append(c),TT.search.dropdownKeywords.show()}TT.search.dropdown.children(".fader").height(TT.search.dropdownResults.outerHeight())},TT.search.hideResults=function(){TT.search.dropdown.removeClass("open")},TT.chapternav={},TT.chapternav.initialize=function(){$("#chapter-nav ul li").click(TT.chapternav.onChapterClick),TT.IS_TOUCH_DEVICE||($("#chapter-nav ul li").mouseover(TT.chapternav.onChapterMouseOver),$("#chapter-nav ul li").mouseout(TT.chapternav.onChapterMouseOut)),$("#chapter-nav ul li .over div.description").css({opacity:0})},TT.chapternav.updateReadMarkers=function(){$("#chapter-nav ul li").each(function(){var a=$("a",this).attr("data-article");TT.storage.hasArticleBeenRead(a)&&$(this).addClass("read")})},TT.chapternav.getDisabledArticles=function(){var a=[];return $("#chapter-nav ul li.disabled").each(function(){var b=$("a",this).attr("data-article");b&&a.push(b)}),a},TT.chapternav.updateSelection=function(a){var b=TT.navigation.classToArticle($("#pages section.current").attr("class"));a&&(b=a),$("#chapter-nav ul li").removeClass("selected");if(b&&!TT.navigation.isHomePage()&&!TT.navigation.isCreditsPage()&&!TT.navigation.isForeword()){var c=$("#chapter-nav ul li").find("[data-article="+b+"]");c&&c.parent()&&(c.parent().addClass("selected"),TT.sharing.updateSharerIndex(c.parent().index()+1))}(!TT.storage.isFirstTimeVisitor||!TT.navigation.isHomePage()||TT.navigation.hasNavigated)&&$("#chapter-nav").show(),$("#chapter-nav ul li a.over").each(function(){$(this).css({top:-$(this).height()+4})})},TT.chapternav.getProgress=function(a){var b=$("#chapter-nav ul li.selected");return a&&(b=$("#chapter-nav ul li").find("[data-article="+a+"]").parent()),TT.navigation.isHomePage()||TT.navigation.isForeword()?0:TT.navigation.isCreditsPage()||TT.navigation.isLastPage()||b.length==0?1:Math.min(b.index()/($("#chapter-nav ul li:not(.disabled)").length-1),1)},TT.chapternav.onChapterClick=function(a){var b=$(a.target).is("li")?$(a.target):$(a.target).parents("li"),c=$("a",b).attr("data-article");c&&!b.hasClass("disabled")&&TT.navigation.goToPage(c,1)&&(TT.chapternav.getProgress(c)>TT.chapternav.getProgress()&&TT.paperstack.updateStack(TT.chapternav.getProgress(c)),TT.chapternav.updateSelection(c)),a.preventDefault()},TT.chapternav.onChapterMouseOver=function(a){var b=$(a.target).is("li")?$(a.target):$(a.target).parents("li"),c=$("div.description",b);c.stop(!0,!1).fadeTo(200,1)},TT.chapternav.onChapterMouseOut=function(a){var b=$(a.target).is("li")?$(a.target):$(a.target).parents("li"),c=$("div.description",b);c.fadeTo(200,0)},TT.sharing={};var l=window.location;TT.sharing.BASE_URL=l.protocol+"//"+l.hostname+"/"+SERVER_VARIABLES.LANG,TT.sharing.FACEBOOK_SHARER="http://www.facebook.com/sharer.php",TT.sharing.TWITTER_SHARER="http://twitter.com/share",TT.sharing.BUZZ_SHARER="http://www.google.com/buzz/post",TT.sharing.initialize=function(){$("footer div.sharing .facebook, #credits div.share .facebook").click(TT.sharing.shareBookOnFacebook),$("footer div.sharing .twitter, #credits div.share .twitter").click(TT.sharing.shareBookOnTwitter),$("footer div.sharing .buzz, #credits div.share .buzz").click(TT.sharing.shareBookOnBuzz),$("footer div.sharing .url").click(TT.sharing.openClipboardNotification),$("#sharer div.content ul li.facebook").click(TT.sharing.shareChapterOnFacebook),$("#sharer div.content ul li.twitter").click(TT.sharing.shareChapterOnTwitter),$("#sharer div.content ul li.buzz").click(TT.sharing.shareChapterOnBuzz),$("#sharer div.content ul li.print").click(TT.sharing.printThing),$(document).mousedown(TT.sharing.documentMouseDownHandler)},TT.sharing.updateSharer=function(a){var b=TT.navigation.classToArticle($("#pages section.current").attr("class"));$("#sharer div.content ul li.print a").attr("href","/"+SERVER_VARIABLES.LANG+"/"+b+"/print"),TT.navigation.isHomePage()||TT.navigation.isCreditsPage()||TT.navigation.isLastPage()||TT.navigation.isForeword()||a?($("#sharer").stop(!0,!0),$("#sharer").fadeOut(150)):$("#sharer").stop(!0,!0).delay(150).fadeIn(150)},TT.sharing.updateSharerIndex=function(a){if(a!=0){if(a!=$("#sharer div.content p.index span").text()){$("#sharer div.content p.index span").each(function(a){a>1&&$(this).remove()}),$("#sharer div.content p.index span").delay(300).fadeOut(200,function(){$(this).remove()});var b=$("<span>"+a+"</span>");b.hide().delay(300).fadeIn(200),$("#sharer div.content p.index").append(b),TT.sharing.updateSharer()}}else $("#sharer").fadeOut()},TT.sharing.openClipboardNotification=function(){return $("footer .clipboard-notification").show().focus().select(),!1},TT.sharing.documentMouseDownHandler=function(a){if(a&&a.target===$("footer .clipboard-notification")[0])return $("footer .clipboard-notification").focus().select(),!1;$("footer .clipboard-notification").fadeOut(200)},TT.sharing.shareBookOnFacebook=function(){var a=TT.sharing.BASE_URL,b=SERVER_VARIABLES.FACEBOOK_MESSAGE;return TT.sharing.shareOnFacebook(a,b),!1},TT.sharing.shareBookOnTwitter=function(){var a=TT.sharing.BASE_URL,b=SERVER_VARIABLES.TWITTER_MESSAGE;return TT.sharing.shareOnTwitter(a,b),!1},TT.sharing.shareBookOnBuzz=function(){var a=TT.sharing.BASE_URL,b=SERVER_VARIABLES.BUZZ_MESSAGE;return TT.sharing.shareOnBuzz(a,b),!1},TT.sharing.shareChapterOnFacebook=function(){var a=TT.sharing.BASE_URL+"/"+TT.navigation.getCurrentArticleId(),b=SERVER_VARIABLES.FACEBOOK_MESSAGE_SINGLE;return TT.sharing.shareOnFacebook(a,b),!1},TT.sharing.shareChapterOnTwitter=function(){var a=TT.sharing.BASE_URL+"/"+TT.navigation.getCurrentArticleId(),b=SERVER_VARIABLES.TWITTER_MESSAGE_SINGLE;return TT.sharing.shareOnTwitter(a,b),!1},TT.sharing.shareChapterOnBuzz=function(){var a=TT.sharing.BASE_URL+"/"+TT.navigation.getCurrentArticleId(),b=SERVER_VARIABLES.BUZZ_MESSAGE_SINGLE;return TT.sharing.shareOnBuzz(a,b),!1},TT.sharing.shareOnFacebook=function(a,b){var c=TT.sharing.FACEBOOK_SHARER;c+="?u="+encodeURIComponent(a),c+="&t="+encodeURIComponent(b),window.open(c,"Facebook","toolbar=0,status=0,width=726,location=no,menubar=no,height=436")},TT.sharing.shareOnTwitter=function(a,b){var c=TT.sharing.TWITTER_SHARER;c+="?original_referer="+encodeURIComponent(a),c+="&text="+encodeURIComponent(b),c+="&url="+encodeURIComponent(a),window.open(c,"Twitter","toolbar=0,status=0,width=726,location=no,menubar=no,height=436")},TT.sharing.shareOnBuzz=function(a,b){var c=TT.sharing.BUZZ_SHARER;c+="?url="+encodeURIComponent(a),c+="&message="+encodeURIComponent(b),c+="&imageurl="+encodeURIComponent(TT.sharing.BASE_URL+"../../img/wordbook/front-cover.jpg"),window.open(c,"Buzz","toolbar=0,status=0,width=726,location=no,menubar=no,height=436")},TT.overlay={},TT.overlay.overlay=null,TT.overlay.bookmark=null,TT.overlay.print=null,TT.overlay.visible=!1,TT.overlay.initialize=function(){TT.overlay.overlay=$("#overlay"),TT.overlay.bookmark=$("#overlay div.bookmark"),TT.overlay.print=$("#overlay div.print")},TT.overlay.showBookmark=function(a,b,c){TT.overlay.overlay.stop().fadeIn(200),TT.overlay.bookmark.siblings().hide(),TT.overlay.bookmark.stop().fadeIn(200),$("a.resume",TT.overlay.bookmark).click(function(){return TT.overlay.hide(),a(),!1}),$("a.restart",TT.overlay.bookmark).click(function(){return TT.overlay.hide(),b(),!1}),$("a.close",TT.overlay.bookmark).click(function(){return TT.overlay.hide(),c(),!1}),TT.overlay.visible=!0,TT.overlay.hasShownBookmark=!0,TT.pageflip.unregisterEventListeners(),$("body").addClass("overlay")},TT.overlay.showPrint=function(){TT.overlay.overlay.stop().fadeIn("fast"),TT.overlay.print.siblings().hide(),TT.overlay.print.stop().fadeIn("fast"),$("a.close",TT.overlay.print).click(function(){return TT.overlay.hide(),!1}),$("a.downloadPdf.disabled",TT.overlay.print).click(function(){return!1}),TT.overlay.visible=!0,TT.pageflip.unregisterEventListeners(),$("body").addClass("overlay")},TT.overlay.hide=function(){TT.overlay.overlay.stop().fadeOut("fast"),TT.overlay.bookmark.stop().fadeOut("fast"),TT.overlay.print.stop().fadeOut("fast"),TT.overlay.visible=!1,TT.pageflip.registerEventListeners(),$("body").removeClass("overlay")},TT.tableofthings={},TT.tableofthings.COLUMNS=5,TT.tableofthings.visible=!1,TT.tableofthings.initialize=function(){$("#table-of-contents ul li").mouseenter(TT.tableofthings.onChapterMouseOver),$("#table-of-contents ul li").mouseleave(TT.tableofthings.onChapterMouseOut),$("#table-of-contents ul li").click(TT.tableofthings.onChapterClick)},TT.tableofthings.updateReadMarkers=function(){$("#table-of-contents ul li").each(function(){var a=$("a",this).attr("data-article");TT.storage.hasArticleBeenRead(a)&&$(this).addClass("read")})},TT.tableofthings.updateSelection=function(a){var b=TT.navigation.classToArticle($("#pages section.current").attr("class"));a&&(b=a),$("#table-of-contents ul li").removeClass("selected");if(b){var c=$("#table-of-contents ul li").find("[data-article*="+b+"]");c&&c.parent()&&c.parents("li").addClass("selected")}},TT.tableofthings.show=function(){TT.tableofthings.visible||($("body").addClass("tot"),$("#table-of-contents").stop(!0,!0).show().fadeTo(200,1),$("#table-of-contents div.header").stop().css({opacity:1}),TT.tableofthings.truncate(),$("#table-of-contents ul li").each(function(a){var b=Math.floor(a/TT.tableofthings.COLUMNS),c=a%TT.tableofthings.COLUMNS;b++,c++,$(this).stop().css({opacity:0}).show().delay((b+c)*50).fadeTo(100,1)}),TT.updateLayout()),TT.tableofthings.visible=!0,TT.pageflip.unregisterEventListeners()},TT.tableofthings.hide=function(){$("body").removeClass("tot"),$("#table-of-contents").delay(200).fadeTo(200,0,function(){$(this).hide()}),$("#table-of-contents div.header").stop().fadeTo(150,0);var a=$("#table-of-contents ul li").length;$("#table-of-contents ul li").each(function(b){var c=Math.floor((a-1-b)/TT.tableofthings.COLUMNS),d=(a-1-b)%TT.tableofthings.COLUMNS;c++,d++,$(this).stop().fadeTo((c+d)*40,0)}),TT.tableofthings.visible=!1,TT.navigation.isFullScreen()||TT.pageflip.registerEventListeners(),TT.updateLayout()},TT.tableofthings.onChapterClick=function(a){if($("body").hasClass("tot")){var b=$(a.target).parents("li").children("a").attr("data-article");b||(b=$(a.target).children("a").attr("data-article")),TT.navigation.goToPage(b,1)&&(TT.tableofthings.hide(),TT.chapternav.updateSelection(b),TT.tableofthings.updateSelection(b))}return!1},TT.tableofthings.onChapterMouseOver=function(a){$(this).find(".extended").show(),$(this).find(".ellipsis").hide(),$(this).find("p.fullyTruncated").show();if($(a.target).parents("li").hasClass("disabled")||$(a.target).parents("li").hasClass("selected"))return!1},TT.tableofthings.onChapterMouseOut=function(a){$(this).find(".extended").hide(),$(this).find(".ellipsis").show(),$(this).find("p.fullyTruncated").hide()},TT.tableofthings.truncate=function(){$("#table-of-contents ul li").each(function(a){var b=$(this),c=b.find("a");b.css("z-index",1e3-a),c.outerHeight()>130&&TT.tableofthings.findSliceLength(c)})},TT.tableofthings.findSliceLength=function(a){var b=a.find("p").eq(1),c=b.text().length,d=b.text(),e=c;while(a.outerHeight()>130){c=e=d.lastIndexOf(" ",e-1),c<=0&&(c=0);var f=d.slice(0,c),g=d.slice(c),h=g.length>0&&c!=0?" ...":"";b.html('<span class="tease">'+f+'</span><span class="ellipsis">'+h+'</span><span class="extended" style="display:none;">'+g+"</span>");if(c==0){b.addClass("fullyTruncated").hide();break}}var i=a.find("h3");c=i.text().length,d=i.text();var e=c;while(a.outerHeight()>130){c=e=d.lastIndexOf(" ",e-1);var f=d.slice(0,c),g=d.slice(c),h=g.length>0?" ...":"";i.html('<span class="tease">'+f+'</span><span class="ellipsis">'+h+'</span><span class="extended" style="display:none;">'+g+"</span>")}},TT.flipintro={},TT.flipintro.WIDTH=89,TT.flipintro.HEIGHT=29,TT.flipintro.VSPACE=20,TT.flipintro.loopInterval=-1,TT.flipintro.canvas=null,TT.flipintro.context=null,TT.flipintro.flip={progress:0,alpha:0},TT.flipintro.initialize=function(){TT.flipintro.canvas=$("#flip-intro"),TT.flipintro.canvas[0]&&(TT.flipintro.canvas[0].width=TT.flipintro.WIDTH,TT.flipintro.canvas[0].height=TT.flipintro.HEIGHT+TT.flipintro.VSPACE*2,TT.flipintro.context=TT.flipintro.canvas[0].getContext("2d"))},TT.flipintro.activate=function(){TT.flipintro.loopInterval==-1&&(TT.flipintro.flip.progress=1,TT.flipintro.loopInterval=setInterval(TT.flipintro.render,32))},TT.flipintro.deactivate=function(){clearInterval(TT.flipintro.loopInterval),TT.flipintro.loopInterval=-1},TT.flipintro.render=function(){if(!TT.flipintro.canvas[0])return;TT.flipintro.context.clearRect(0,0,TT.flipintro.WIDTH,TT.flipintro.HEIGHT+TT.flipintro.VSPACE*2),TT.navigation.isHomePage()||TT.flipintro.deactivate(),TT.flipintro.flip.progress-=Math.max(.12*(1-Math.abs(TT.flipintro.flip.progress)),.02),TT.flipintro.flip.alpha=1-(Math.abs(TT.flipintro.flip.progress)-.7)/.3,TT.flipintro.flip.progress<-2&&(TT.flipintro.flip.progress=1);var a=1-Math.abs(TT.flipintro.flip.progress),b=a*12,c=a*8,d={top:{x:TT.flipintro.WIDTH*.5,y:TT.flipintro.VSPACE},bottom:{x:TT.flipintro.WIDTH*.5,y:TT.flipintro.HEIGHT+TT.flipintro.VSPACE}},e={top:{x:d.top.x+TT.flipintro.WIDTH*TT.flipintro.flip.progress*.6,y:TT.flipintro.VSPACE-b},bottom:{x:d.bottom.x+TT.flipintro.WIDTH*TT.flipintro.flip.progress*.6,y:TT.flipintro.HEIGHT+TT.flipintro.VSPACE-b}},f={top:{x:d.top.x+12*TT.flipintro.flip.progress,y:TT.flipintro.VSPACE-c},bottom:{x:d.bottom.x+12*TT.flipintro.flip.progress,y:TT.flipintro.HEIGHT+TT.flipintro.VSPACE-c}};TT.flipintro.context.fillStyle="rgba(238,238,238,"+TT.flipintro.flip.alpha+")",TT.flipintro.context.strokeStyle="rgba(90,90,90,"+TT.flipintro.flip.alpha+")",TT.flipintro.context.beginPath(),TT.flipintro.context.moveTo(d.top.x,d.top.y),TT.flipintro.context.quadraticCurveTo(f.top.x,f.top.y,e.top.x,e.top.y),TT.flipintro.context.lineTo(e.bottom.x,e.bottom.y),TT.flipintro.context.quadraticCurveTo(f.bottom.x,f.bottom.y,d.bottom.x,d.bottom.y),TT.flipintro.context.fill(),TT.flipintro.context.stroke()},TT.locale={},TT.locale.title=null,TT.locale.list=null,TT.locale.initialize=function(){this.title=$("#language-selector-title"),this.list=$("#language-selector-list"),this.title.click(function(){$(this).hasClass("open")?TT.locale.closeList():TT.locale.openList()}),$("li a",this.list).attr("href","#").click(function(a){var b=$(this).parents("li").attr("data-locale"),c=TT.locale.removeLocaleCodeFromURL(document.location.pathname);document.location="/"+b+c,a.preventDefault()}),this.title.mousedown(function(a){a.preventDefault()})},TT.locale.onDocumentMouseDown=function(a){$(a.target).parents("#language-selector").length===0&&TT.locale.closeList()},TT.locale.openList=function(){this.title.addClass("open"),this.list.addClass("open"),$(document).bind("mousedown",this.onDocumentMouseDown)},TT.locale.closeList=function(){this.title.removeClass("open"),this.list.removeClass("open"),$(document).unbind("mousedown",this.onDocumentMouseDown)},TT.locale.getLocaleCodeFromURL=function(){var a=document.location.pathname;return a.indexOf("fil-PH")>0?a=a.match(/\/fil-PH/gi)||"":a.indexOf("es-419")>0?a=a.match(/\/es-419/gi)||"":a=a.match(/\/(..\-..)/gi)||"",a=a.toString().replace(/\//gi,""),a?a:"en-US"},TT.locale.getLanguageFromLocaleCode=function(a){var b=a.slice(0,a.indexOf("-"));return b?b:locale},TT.locale.removeLocaleCodeFromURL=function(a){return a.indexOf("fil-PH")>0?a.replace(/\/fil-PH/gi,""):a.indexOf("es-419")>0?a.replace(/\/es-419/gi,""):a.replace(/\/(..\-..)/gi,"")};