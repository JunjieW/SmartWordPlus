function randomWarning(a){var b=a.length,c=Math.floor(Math.random()*b);return a[c]}function colorGenerator(a){if(a){function b(){return~~(Math.random()*16)<<4|~~(Math.random()*16)}return function(){var a=[b(),b(),b()],c=rgbToHsl(a[0],a[1],a[2]);a=[a[0].toString(16),a[1].toString(16),a[2].toString(16)];var d=[~~(c[0]*255),"100%,70%"];return[a.join(""),d.join(",")]}}return function(){return["FFFF00","60,100%,50%"]}}function getCurrentTime(){var a=new Date;return a.getTime()}function showTooltipWithWord(a,b,c){var d=$(document.body).qtip();d.show(a);var e="";this.id?e=this.id:e=b,currentselected=e;var f={};f.word=e;var g=JSON.stringify(f);chrome.runtime.sendMessage({command:"transgetchinese",word:g},function(b){currenttime=getCurrentTime();if(b.farewell=="正在翻译"&&currenttime-begintime<5e3){if(currentselected!=e)return;var f=currenttime-begintime;d.set({"content.title":e,"content.text":" "+f}),showTooltipWithWord(a,e,c)}else{TRANSLATING="翻译中";var g=b.sound,h=b.farewell,i="";g!=""&&tellBackgroundToPlaySound(g,""),b.farewell=="正在翻译"?(tellBackgroundToResetTranslatingFlag(),i="后台仍然在翻译中，您的最优选择是继续阅读。"):b.farewell==ENTRYISNULL?i="该词已不在生词本了，请刷新页面。":b.farewell.indexOf(TOBETRANSLATED)>=0?i="后台仍然在翻译中，您的最优选择是继续阅读。":i=b.farewell,d.set({"content.title":e,"content.text":i}),c&&restoreSelection(c)}})}function highlightWord(a,b,c){c=typeof c!="undefined"?c:document;var d=[],e,f;hastip||($(document.body).qtip({content:".",position:{my:"bottom right",at:"top left",viewport:$(window),target:"mouse",adjust:{mouse:!1}},show:!1,hide:{when:{event:"mouseover mouseout unfocus"},fixed:!0,delay:0},style:"qtip-light"}),hastip=!0);if(a.hasChildNodes){var g;for(g=0;g<a.childNodes.length;g++)e=highlightWord(a.childNodes[g],b,c),d=d.concat(e)}if(a.nodeType==3){tempNodeVal=a.nodeValue.toLowerCase(),tempWordVal=b.toLowerCase();var h=new RegExp("\\b"+tempWordVal+"\\b");tempNodeVal.search(h)!=-1&&(pn=a.parentNode,/^searchword.*$/.test(pn.className)||(nv=a.nodeValue,ni=tempNodeVal.indexOf(tempWordVal),before=c.createTextNode(nv.substr(0,ni)),docWordVal=nv.substr(ni,b.length),after=c.createTextNode(nv.substr(ni+b.length)),hiwordtext=c.createTextNode(docWordVal),hiword=c.createElement("span"),hiword.className="searchword",hiword.id=b,hiword.appendChild(hiwordtext),hiword.onmouseover=showTooltipWithWord,pn.insertBefore(before,a),pn.insertBefore(hiword,a),pn.insertBefore(after,a),pn.removeChild(a),d.push(hiword),tellBackgroundToAddCount(b)))}return d}function unhighlight(a){if(a.hasChildNodes){var b;for(b=0;b<a.childNodes.length;b++)unhighlight(a.childNodes[b])}a.nodeType==3&&(pn=a.parentNode,/^searchword.*$/.test(pn.className)&&(prevSib=pn.previousSibling,nextSib=pn.nextSibling,nextSib.nodeValue=prevSib.nodeValue+a.nodeValue+nextSib.nodeValue,prevSib.nodeValue="",pn.parentNode.removeChild(pn)))}function unhighlightword(a,b){if(a.hasChildNodes){var c;for(c=0;c<a.childNodes.length;c++)unhighlightword(a.childNodes[c],b)}if(a.nodeType==3){tempNodeVal=a.nodeValue.toLowerCase(),tempWordVal=b.toLowerCase();var d=new RegExp("\\b"+tempWordVal+"\\b");tempNodeVal.search(d)!=-1&&(pn=a.parentNode,/^searchword.*$/.test(pn.className)&&(prevSib=pn.previousSibling,nextSib=pn.nextSibling,nextSib.nodeValue=prevSib.nodeValue+a.nodeValue+nextSib.nodeValue,prevSib.nodeValue="",pn.parentNode.removeChild(pn)))}}function localSearchHighlight(a,b){var c=100;b=typeof b!="undefined"?b:document;if(!b.createElement)return;searchstr=unescape(a).replace(/^\s+|\s+$/g,"");if(searchstr=="")return;docmenttext=b.documentElement.innerText.toLowerCase();if(docmenttext.indexOf(searchstr)<0)return;var d=[];colorGen=colorGenerator(!0),col=colorGen(),begintime=getCurrentTime(),currentselected=searchstr,d=highlightWord(b.getElementsByTagName("body")[0],searchstr,b);for(x=0;x<d.length;x++)d[x].className+=col[0];cssstr+=cssstr.indexOf(col[0])==-1?".searchword"+col[0]+"{background-color:hsl("+col[1]+")}":"",cssstr.length&&updateStyleNode(cssstr)}var hastip=!1,begintime=0,currenttime=0,ENTRYISNULL="生词本中没有这个词",TOBETRANSLATED="后台翻译中",TRANSLATING="翻译中",currentselected="",errtimeout;